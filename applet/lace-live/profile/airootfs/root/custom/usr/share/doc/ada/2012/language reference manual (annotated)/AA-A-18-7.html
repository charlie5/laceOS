<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<HTML>
<HEAD>
    <TITLE>Sets</TITLE>
    <META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <META NAME="Author" CONTENT="JTC1/SC22/WG9/ARG, by Randall Brukardt, ARG Editor">
    <META NAME="GENERATOR" CONTENT="Arm_Form.Exe, Ada Reference Manual generator">
    <STYLE type="text/css">
    H4.centered {text-align: center}
    SPAN.swiss {font-family: Arial, Helvetica, sans-serif; font-size: 92%}
    SPAN.roman {font-family: "Times New Roman", Times, serif}
    DIV.paranum {float: left; font-family: Arial, Helvetica, sans-serif; font-size: 64%; width: 2.8em; margin-left: -0.4em; margin-right: -3.0em; margin-top: 0.2em}
    TT {font-family: "Courier New", monospace}
    DT {display: compact}
    SPAN.insert4 {text-decoration: underline; color: rgb(153,0,0) }
    SPAN.delete4 {text-decoration: line-through; color: rgb(153,0,0) }
    A.Bar:link {font-family: Arial, Helvetica, sans-serif; font-style: normal; text-decoration: none; color: rgb(204,204,51)}
    A.Bar:visited {font-family: Arial, Helvetica, sans-serif; font-style: normal; text-decoration: none; color: rgb(204,204,51)}
    DIV.Normal {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 1.2em; margin-bottom: 0.6em}
    DIV.Indented2 {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 5.2em; margin-bottom: 0.6em}
    DIV.Annotations {font-family: "Times New Roman", Times, serif; font-size: 80%; line-height: 122%; margin-left: 6.2em; margin-bottom: 0.6em}
    DIV.Examples {font-family: "Courier New", monospace; font-size: 90%; line-height: 122%; margin-left: 3.4em; margin-bottom: 0.6em}
    DIV.SmallExamples {font-family: "Courier New", monospace; font-size: 72%; line-height: 122%; margin-left: 9.6em; margin-bottom: 0.6em}
    DIV.Bulleted-NoPrefix {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 3.2em; margin-right: 2.0em; margin-top: 0em; margin-bottom: 0.5em}
    DIV.Bulleted {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 3.2em; margin-right: 2.0em; margin-top: 0em; margin-bottom: 0.5em; display: list-item; list-style-type: disc}
    </STYLE>
</HEAD>
<BODY TEXT="#000000" BGCOLOR="#FFFFF0" LINK="#000080" VLINK="#330033" ALINK="#0000FF">
<DIV><B><SPAN Style="font-size:200%; color: rgb(0,51,153)">Annotated</SPAN><SPAN Style="font-size:200%; color: rgb(0,0,102)">&nbsp;Ada Reference Manual</SPAN></B> &mdash; <A HREF="AA-TTL.html"><B>Legal Information</B></A></DIV>
<div style="margin-top: 0.6em; margin-bottom: 0.0em"><A HREF="AA-TOC.html"><IMG SRC="cont.gif" ALT="Contents" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-0-5.html"><IMG SRC="index.gif" ALT="Index" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-STDS.html"><IMG SRC="lib.gif" ALT="References" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-SRCH.html"><IMG SRC="find.gif" ALT="Search" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-A-18-6.html"><IMG SRC="prev.gif" ALT="Previous" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-A-18-8.html"><IMG SRC="next.gif" ALT="Next" BORDER=0></A>&nbsp;
</div>
<HR>
<H1>A.18.7 Sets</H1>
<div class="paranum"><a name="p1">1/2</a></div>
<div class="Normal">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
The language-defined generic packages Containers.Hashed_Sets and Containers.Ordered_Sets 
provide private types Set and Cursor, and a set of operations for each 
type. A set container allows elements of an arbitrary type to be stored 
without duplication. A hashed set uses a hash function to organize elements, 
while an ordered set orders its element per a specified relation.<A NAME="I7657"></A> 
<A NAME="I7658"></A></div>
<div class="paranum"><a name="p2">2/3</a></div>
<div class="Normal">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0299-1.TXT">AI05-0299-1</A></I>} 
This subclause describes the declarations that are common to both kinds 
of sets. See <A HREF="AA-A-18-8.html">A.18.8</A> for a description of 
the semantics specific to Containers.Hashed_Sets and <A HREF="AA-A-18-9.html">A.18.9</A> 
for a description of the semantics specific to Containers.Ordered_Sets. 
</div>

<H4 Class="centered">Static Semantics</H4>
<div class="paranum"><a name="p3">3/2</a></div>
<div class="Normal">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
The actual function for the generic formal function &quot;=&quot; on 
Element_Type values is expected to define a reflexive and symmetric relationship 
and return the same result value each time it is called with a particular 
pair of values. If it behaves in some other manner, the function &quot;=&quot; 
on set values returns an unspecified value. The exact arguments and number 
of calls of this generic formal function by the function &quot;=&quot; 
on set values are unspecified.<A NAME="I7659"></A></div>
<div class="paranum"><a name="p3.a">3.a/2</a></div>
<div class="Annotations"><B>Ramification:&nbsp;</B>If the actual function 
for &quot;=&quot; is not symmetric and consistent, the result returned 
by the &quot;=&quot; for Set objects cannot be predicted. The implementation 
is not required to protect against &quot;=&quot; raising an exception, 
or returning random results, or any other &ldquo;bad&rdquo; behavior. 
And it can call &quot;=&quot; in whatever manner makes sense. But note 
that only the result of &quot;=&quot; for Set objects is unspecified; 
other subprograms are not allowed to break if &quot;=&quot; is bad (they 
aren't expected to use &quot;=&quot;).&nbsp;</div>
<div class="paranum"><a name="p4">4/2</a></div>
<div class="Normal">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
The type Set is used to represent sets. The type Set needs finalization<A NAME="I7660"></A> 
(see <A HREF="AA-7-6.html">7.6</A>).</div>
<div class="paranum"><a name="p5">5/2</a></div>
<div class="Normal">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
A set contains elements. Set cursors designate elements. There exists 
an equivalence relation on elements, whose definition is different for 
hashed sets and ordered sets. A set never contains two or more equivalent 
elements. The <I>length</I> of a set is the number of elements it contains.<A NAME="I7661"></A></div>
<div class="paranum"><a name="p6">6/2</a></div>
<div class="Normal">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
<A NAME="I7662"></A><A NAME="I7663"></A><A NAME="I7664"></A>Each nonempty 
set has two particular elements called the <I>first element</I> and the 
<I>last element</I> (which may be the same). Each element except for 
the last element has a <I>successor element</I>. If there are no other 
intervening operations, starting with the first element and repeatedly 
going to the successor element will visit each element in the set exactly 
once until the last element is reached. The exact definition of these 
terms is different for hashed sets and ordered sets.</div>
<div class="paranum"><a name="p7">7/2</a></div>
<div class="Normal">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
[Some operations of these generic packages have access-to-subprogram 
parameters. To ensure such operations are well-defined, they guard against 
certain actions by the designated subprogram. In particular, some operations 
check for &ldquo;tampering with cursors&rdquo; of a container because 
they depend on the set of elements of the container remaining constant, 
and others check for &ldquo;tampering with elements&rdquo; of a container 
because they depend on elements of the container not being replaced.]</div>
<div class="paranum"><a name="p8">8/2</a></div>
<div class="Normal" style="margin-bottom: 0.4em">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
<A NAME="I7665"></A>A subprogram is said to <I>tamper with cursors</I> 
of a set object <I>S</I> if:</div>
<div class="paranum"><a name="p9">9/2</a></div>
<div class="Bulleted">it inserts or deletes elements of <I>S</I>, that 
is, it calls the Insert, Include, Clear, Delete, Exclude, or Replace_Element 
procedures with <I>S</I> as a parameter; or</div>
<div class="paranum"><a name="p9.a">9.a/2</a></div>
<div class="Annotations"><B>To be honest:&nbsp;</B>Operations which are defined 
to be equivalent to a call on one of these operations also are included. 
Similarly, operations which call one of these as part of their definition 
are included.&nbsp;</div>
<div class="paranum"><a name="p9.b">9.b/2</a></div>
<div class="Annotations"><B>Discussion:&nbsp;</B>We have to include Replace_Element 
here because it might delete and reinsert the element if it moves in 
the set. That could change the order of iteration, which is what this 
check is designed to prevent. Replace is also included, as it is defined 
in terms of Replace_Element.&nbsp;</div>
<div class="paranum"><a name="p10">10/2</a></div>
<div class="Bulleted">it finalizes <I>S</I>; or</div>
<div class="paranum"><a name="p10.1">10.1/3</a></div>
<div class="Bulleted">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0001-1.TXT">AI05-0001-1</A></I>} 
it calls the Assign procedure with <I>S</I> as the Target parameter; 
or</div>
<div class="paranum"><a name="p10.a">10.a/3</a></div>
<div class="Annotations"><B>Ramification:&nbsp;</B>We don't need to explicitly 
mention <SPAN Class="swiss"><A HREF="AA-5-2.html#S0152">assignment_statement</A></SPAN>, 
because that finalizes the target object as part of the operation, and 
finalization of an object is already defined as tampering with cursors. 
</div>
<div class="paranum"><a name="p11">11/2</a></div>
<div class="Bulleted">it calls the Move procedure with <I>S</I> as a 
parameter; or</div>
<div class="paranum"><a name="p12">12/2</a></div>
<div class="Bulleted">it calls one of the operations defined to tamper 
with cursors of <I>S</I>.</div>
<div class="paranum"><a name="p13">13/2</a></div>
<div class="Normal" style="margin-bottom: 0.4em">&nbsp;{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
<A NAME="I7666"></A>A subprogram is said to <I>tamper with elements</I> 
of a set object <I>S</I> if:</div>
<div class="paranum"><a name="p14">14/2</a></div>
<div class="Bulleted">it tampers with cursors of <I>S</I>.</div>
<div class="paranum"><a name="p14.a">14.a/2</a></div>
<div class="Annotations"><B>Reason:&nbsp;</B>Complete replacement of an element 
can cause its memory to be deallocated while another operation is holding 
onto a reference to it. That can't be allowed. However, a simple modification 
of (part of) an element is not a problem, so Update_Element_Preserving_Key 
does not cause a problem.</div>
<div class="paranum"><a name="p14.b">14.b/2</a></div>
<div class="Annotations">We don't need to list Replace and Replace_Element 
here because they are covered by &ldquo;tamper with cursors&rdquo;. For 
Set, &ldquo;tamper with cursors&rdquo; and &ldquo;tamper with elements&rdquo; 
are the same. We leave both terms so that the rules for routines like 
Iterate and Query_Element are consistent across all containers.&nbsp;</div>
<div class="paranum"><a name="p14.1">14.1/4</a></div>
<div class="Normal">&nbsp;&nbsp;&nbsp;{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0265-1.TXT">AI05-0265-1</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI12s/AI12-0110-1.TXT">AI12-0110-1</A></I>} 
<A NAME="I7667"></A><A NAME="I7668"></A>When tampering with cursors is 
<I>prohibited</I> for a particular set object <I>S</I>, Program_Error 
is propagated by a call of any language-defined subprogram that is defined 
to tamper with the cursors of <I>S</I>, leaving <I>S</I> unmodified. 
Similarly, when tampering with elements is <I>prohibited</I> for a particular 
set object <I>S</I>, Program_Error is propagated by a call of any language-defined 
subprogram that is defined to tamper with the elements of <I>S</I> [(or 
tamper with the cursors of <I>S</I>)], leaving <I>S</I> unmodified.<span class="insert4">&nbsp;These checks are made before any other defined behavior of the body of 
the language-defined subprogram.</span>&nbsp;</div>
<div class="paranum"><a name="p14.c">14.c/3</a></div>
<div class="Annotations"><B>Proof:&nbsp;</B>Tampering with elements includes 
tampering with cursors, so we mention it only from completeness in the 
second sentence.&nbsp;</div>
<div class="paranum"><a name="p15">15/2</a></div>
<div class="Normal">&nbsp;{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
Empty_Set represents the empty Set object. It has a length of 0. If an 
object of type Set is not otherwise initialized, it is initialized to 
the same value as Empty_Set.</div>
<div class="paranum"><a name="p16">16/2</a></div>
<div class="Normal">&nbsp;{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
No_Element represents a cursor that designates no element. If an object 
of type Cursor is not otherwise initialized, it is initialized to the 
same value as No_Element.</div>
<div class="paranum"><a name="p17">17/2</a></div>
<div class="Normal">&nbsp;{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
The predefined &quot;=&quot; operator for type Cursor returns True if 
both cursors are No_Element, or designate the same element in the same 
container.</div>
<div class="paranum"><a name="p18">18/2</a></div>
<div class="Normal">&nbsp;{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
Execution of the default implementation of the Input, Output, Read, or 
Write attribute of type Cursor raises Program_Error.</div>
<div class="paranum"><a name="p18.a">18.a/2</a></div>
<div class="Annotations"><B>Reason:&nbsp;</B>A cursor will probably be implemented 
in terms of one or more access values, and the effects of streaming access 
values is unspecified. Rather than letting the user stream junk by accident, 
we mandate that streaming of cursors raise Program_Error by default. 
The attributes can always be specified if there is a need to support 
streaming.&nbsp;</div>
<div class="paranum"><a name="p18.1">18.1/3</a></div>
<div class="Normal">&nbsp;&nbsp;&nbsp;{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0001-1.TXT">AI05-0001-1</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0262-1.TXT">AI05-0262-1</A></I>} 
Set'Write for a Set object <I>S</I> writes Length(<I>S</I>) elements 
of the set to the stream. It also may write additional information about 
the set.</div>
<div class="paranum"><a name="p18.2">18.2/3</a></div>
<div class="Normal">&nbsp;&nbsp;&nbsp;{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0001-1.TXT">AI05-0001-1</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0262-1.TXT">AI05-0262-1</A></I>} 
Set'Read reads the representation of a set from the stream, and assigns 
to <I>Item</I> a set with the same length and elements as was written 
by Set'Write.</div>
<div class="paranum"><a name="p18.b">18.b/3</a></div>
<div class="Annotations"><B>Ramification:&nbsp;</B>Streaming more elements 
than the container length is wrong. For implementation implications of 
this rule, see the Implementation Note in <A HREF="AA-A-18-2.html">A.18.2</A>. 
</div>
<div class="paranum"><a name="p18.3">18.3/3</a></div>
<div class="Examples"><B>function</B>&nbsp;Has_Element&nbsp;(Position&nbsp;:&nbsp;Cursor)&nbsp;<B>return</B>&nbsp;Boolean;</div>
<div class="paranum"><a name="p18.4">18.4/3</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0212-1.TXT">AI05-0212-1</A></I>} 
Returns True if Position designates an element, and returns False otherwise.</div>
<div class="paranum"><a name="p18.c">18.c/3</a></div>
<div class="Annotations"><B>To be honest:&nbsp;</B>{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0005-1.TXT">AI05-0005-1</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0212-1.TXT">AI05-0212-1</A></I>} 
This function might not detect cursors that designate deleted elements; 
such cursors are invalid (see below) and the result of calling Has_Element 
with an invalid cursor is unspecified (but not erroneous).&nbsp;</div>
<div class="paranum"><a name="p19">19/2</a></div>
<div class="Examples"><B>function</B>&nbsp;&quot;=&quot;&nbsp;(Left,&nbsp;Right&nbsp;:&nbsp;Set)&nbsp;<B>return</B>&nbsp;Boolean;</div>
<div class="paranum"><a name="p20">20/2</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
If Left and Right denote the same set object, then the function returns 
True. If Left and Right have different lengths, then the function returns 
False. Otherwise, for each element <I>E</I> in Left, the function returns 
False if an element equal to <I>E</I> (using the generic formal equality 
operator) is not present in Right. If the function has not returned a 
result after checking all of the elements, it returns True. Any exception 
raised during evaluation of element equality is propagated.&nbsp;</div>
<div class="paranum"><a name="p20.a">20.a/2</a></div>
<div class="Annotations"><B>Implementation Note:&nbsp;</B>This wording describes 
the canonical semantics. However, the order and number of calls on the 
formal equality function is unspecified for all of the operations that 
use it in this package, so an implementation can call it as many or as 
few times as it needs to get the correct answer. Specifically, there 
is no requirement to call the formal equality additional times once the 
answer has been determined.&nbsp;</div>
<div class="paranum"><a name="p21">21/2</a></div>
<div class="Examples"><B>function</B>&nbsp;Equivalent_Sets&nbsp;(Left,&nbsp;Right&nbsp;:&nbsp;Set)&nbsp;<B>return</B>&nbsp;Boolean;</div>
<div class="paranum"><a name="p22">22/2</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
If Left and Right denote the same set object, then the function returns 
True. If Left and Right have different lengths, then the function returns 
False. Otherwise, for each element <I>E</I> in Left, the function returns 
False if an element equivalent to <I>E</I> is not present in Right. If 
the function has not returned a result after checking all of the elements, 
it returns True. Any exception raised during evaluation of element equivalence 
is propagated.</div>
<div class="paranum"><a name="p23">23/2</a></div>
<div class="Examples"><B>function</B>&nbsp;To_Set&nbsp;(New_Item&nbsp;:&nbsp;Element_Type)&nbsp;<B>return</B>&nbsp;Set;</div>
<div class="paranum"><a name="p24">24/2</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
Returns a set containing the single element New_Item.</div>
<div class="paranum"><a name="p25">25/2</a></div>
<div class="Examples"><B>function</B>&nbsp;Length&nbsp;(Container&nbsp;:&nbsp;Set)&nbsp;<B>return</B>&nbsp;Count_Type;</div>
<div class="paranum"><a name="p26">26/2</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
Returns the number of elements in Container.</div>
<div class="paranum"><a name="p27">27/2</a></div>
<div class="Examples"><B>function</B>&nbsp;Is_Empty&nbsp;(Container&nbsp;:&nbsp;Set)&nbsp;<B>return</B>&nbsp;Boolean;</div>
<div class="paranum"><a name="p28">28/2</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
Equivalent to Length (Container) = 0.</div>
<div class="paranum"><a name="p29">29/2</a></div>
<div class="Examples"><B>procedure</B>&nbsp;Clear&nbsp;(Container&nbsp;:&nbsp;<B>in&nbsp;out</B>&nbsp;Set);</div>
<div class="paranum"><a name="p30">30/2</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
Removes all the elements from Container.</div>
<div class="paranum"><a name="p31">31/2</a></div>
<div class="Examples"><B>function</B>&nbsp;Element&nbsp;(Position&nbsp;:&nbsp;Cursor)&nbsp;<B>return</B>&nbsp;Element_Type;</div>
<div class="paranum"><a name="p32">32/2</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
If Position equals No_Element, then Constraint_Error is propagated. Otherwise, 
Element returns the element designated by Position.</div>
<div class="paranum"><a name="p33">33/2</a></div>
<div class="Examples"><B>procedure</B>&nbsp;Replace_Element&nbsp;(Container&nbsp;:&nbsp;<B>in&nbsp;out</B>&nbsp;Set;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Position&nbsp;&nbsp;:&nbsp;<B>in</B>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cursor;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;New_Item&nbsp;&nbsp;:&nbsp;<B>in</B>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Element_Type);</div>
<div class="paranum"><a name="p34">34/2</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
If Position equals No_Element, then Constraint_Error is propagated; if 
Position does not designate an element in Container, then Program_Error 
is propagated. If an element equivalent to New_Item is already present 
in Container at a position other than Position, Program_Error is propagated. 
Otherwise, Replace_Element assigns New_Item to the element designated 
by Position. Any exception raised by the assignment is propagated.</div>
<div class="paranum"><a name="p34.a">34.a/2</a></div>
<div class="Annotations"><B>Implementation Note:&nbsp;</B>The final assignment 
may require that the node of the element be moved in the Set's data structures. 
That could mean that implementing this operation exactly as worded above 
could require the overhead of searching twice. Implementations are encouraged 
to avoid this extra overhead when possible, by prechecking if the old 
element is equivalent to the new one, by inserting a placeholder node 
while checking for an equivalent element, and similar optimizations.</div>
<div class="paranum"><a name="p34.b">34.b/2</a></div>
<div class="Annotations">The cursor still designates the same element 
after this operation; only the value of that element has changed. Cursors 
cannot include information about the relative position of an element 
in a Set (as they must survive insertions and deletions of other elements), 
so this should not pose an implementation hardship.&nbsp;</div>
<div class="paranum"><a name="p35">35/2</a></div>
<div class="Examples"><B>procedure</B>&nbsp;Query_Element<BR>
&nbsp;&nbsp;(Position&nbsp;:&nbsp;<B>in</B>&nbsp;Cursor;<BR>
&nbsp;&nbsp;&nbsp;Process&nbsp;&nbsp;:&nbsp;<B>not&nbsp;null&nbsp;access&nbsp;procedure</B>&nbsp;(Element&nbsp;:&nbsp;<B>in</B>&nbsp;Element_Type));</div>
<div class="paranum"><a name="p36">36/3</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0021-1.TXT">AI05-0021-1</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0265-1.TXT">AI05-0265-1</A></I>} 
If Position equals No_Element, then Constraint_Error is propagated. Otherwise, 
Query_Element calls Process.<B>all</B> with the element designated by 
Position as the argument. Tampering with the elements of the set that 
contains the element designated by Position is prohibited during the 
execution of the call on Process.<B>all</B>. Any exception raised by 
Process.<B>all</B> is propagated.</div>
<div class="paranum"><a name="p36.1">36.1/3</a></div>
<div class="Examples"><B>type</B>&nbsp;Constant_Reference_Type<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Element&nbsp;:&nbsp;<B>not&nbsp;null&nbsp;access&nbsp;constant</B>&nbsp;Element_Type)&nbsp;<B>is&nbsp;private</B><BR>
&nbsp;&nbsp;&nbsp;<B>with</B>&nbsp;Implicit_Dereference&nbsp;=&gt;&nbsp;Element;</div>
<div class="paranum"><a name="p36.2">36.2/3</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0212-1.TXT">AI05-0212-1</A></I>} 
The type Constant_Reference_Type needs finalization.<A NAME="I7669"></A></div>
<div class="paranum"><a name="p36.3">36.3/3</a></div>
<div class="Indented2">The default initialization of an object of type 
Constant_Reference_Type propagates Program_Error.</div>
<div class="paranum"><a name="p36.a">36.a/3</a></div>
<div class="Annotations"><B>Reason:&nbsp;</B>It is expected that Constant_Reference_Type 
will be a controlled type, for which finalization will have some action 
to terminate the tampering check for the associated container. If the 
object is created by default, however, there is no associated container. 
Since this is useless, and supporting this case would take extra work, 
we define it to raise an exception.&nbsp;</div>
<div class="paranum"><a name="p36.4">36.4/3</a></div>
<div class="Examples"><B>function</B>&nbsp;Constant_Reference&nbsp;(Container&nbsp;:&nbsp;<B>aliased&nbsp;in</B>&nbsp;Set;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Position&nbsp;&nbsp;:&nbsp;<B>in</B>&nbsp;Cursor)<BR>
&nbsp;&nbsp;&nbsp;<B>return</B>&nbsp;Constant_Reference_Type;</div>
<div class="paranum"><a name="p36.5">36.5/3</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0212-1.TXT">AI05-0212-1</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0269-1.TXT">AI05-0269-1</A></I>} 
This function (combined with the Constant_Indexing and Implicit_Dereference 
aspects) provides a convenient way to gain read access to an individual 
element of a set given a cursor.</div>
<div class="paranum"><a name="p36.6">36.6/3</a></div>
<div class="Indented2">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0212-1.TXT">AI05-0212-1</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0265-1.TXT">AI05-0265-1</A></I>} 
If Position equals No_Element, then Constraint_Error is propagated; if 
Position does not designate an element in Container, then Program_Error 
is propagated. Otherwise, Constant_Reference returns an object whose 
discriminant is an access value that designates the element designated 
by Position. Tampering with the elements of Container is prohibited while 
the object returned by Constant_Reference exists and has not been finalized.</div>
<div class="paranum"><a name="p36.7">36.7/3</a></div>
<div class="Examples"><B>procedure</B>&nbsp;Assign&nbsp;(Target&nbsp;:&nbsp;<B>in&nbsp;out</B>&nbsp;Set;&nbsp;Source&nbsp;:&nbsp;<B>in</B>&nbsp;Set);</div>
<div class="paranum"><a name="p36.8">36.8/3</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0001-1.TXT">AI05-0001-1</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0248-1.TXT">AI05-0248-1</A></I>} 
If Target denotes the same object as Source, the operation has no effect. 
Otherwise, the elements of Source are copied to Target as for an <SPAN Class="swiss"><A HREF="AA-5-2.html#S0152">assignment_statement</A></SPAN> 
assigning Source to Target.&nbsp;</div>
<div class="paranum"><a name="p36.b">36.b/3</a></div>
<div class="Annotations"><B>Discussion:&nbsp;</B>{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0005-1.TXT">AI05-0005-1</A></I>} 
This routine exists for compatibility with the bounded set containers. 
For an unbounded set, <TT>Assign(A, B)</TT> and <TT>A := B</TT> behave 
identically. For a bounded set, := will raise an exception if the container 
capacities are different, while Assign will not raise an exception if 
there is enough room in the target.&nbsp;</div>
<div class="paranum"><a name="p37">37/2</a></div>
<div class="Examples"><B>procedure</B>&nbsp;Move&nbsp;(Target&nbsp;:&nbsp;<B>in&nbsp;out</B>&nbsp;Set;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Source&nbsp;:&nbsp;<B>in&nbsp;out</B>&nbsp;Set);</div>
<div class="paranum"><a name="p38">38/3</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0001-1.TXT">AI05-0001-1</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0248-1.TXT">AI05-0248-1</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0262-1.TXT">AI05-0262-1</A></I>} 
If Target denotes the same object as Source, then the operation has no 
effect. Otherwise, the operation is equivalent to Assign (Target, Source) 
followed by Clear (Source).</div>
<div class="paranum"><a name="p39">39/2</a></div>
<div class="Examples"><B>procedure</B>&nbsp;Insert&nbsp;(Container&nbsp;:&nbsp;<B>in&nbsp;out</B>&nbsp;Set;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;New_Item&nbsp;&nbsp;:&nbsp;<B>in</B>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Element_Type;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Position&nbsp;&nbsp;:&nbsp;&nbsp;&nbsp;&nbsp;<B>out</B>&nbsp;Cursor;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Inserted&nbsp;&nbsp;:&nbsp;&nbsp;&nbsp;&nbsp;<B>out</B>&nbsp;Boolean);</div>
<div class="paranum"><a name="p40">40/2</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
Insert checks if an element equivalent to New_Item is already present 
in Container. If a match is found, Inserted is set to False and Position 
designates the matching element. Otherwise, Insert adds New_Item to Container; 
Inserted is set to True and Position designates the newly-inserted element. 
Any exception raised during allocation is propagated and Container is 
not modified.</div>
<div class="paranum"><a name="p41">41/2</a></div>
<div class="Examples"><B>procedure</B>&nbsp;Insert&nbsp;(Container&nbsp;:&nbsp;<B>in&nbsp;out</B>&nbsp;Set;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;New_Item&nbsp;&nbsp;:&nbsp;<B>in</B>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Element_Type);</div>
<div class="paranum"><a name="p42">42/2</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
Insert inserts New_Item into Container as per the four-parameter Insert, 
with the difference that if an element equivalent to New_Item is already 
in the set, then Constraint_Error is propagated.</div>
<div class="paranum"><a name="p42.a">42.a/2</a></div>
<div class="Annotations" style="margin-bottom: 0.4em"><B>Discussion: 
</B>This is equivalent to:&nbsp;</div>
<div class="paranum"><a name="p42.b">42.b/2</a></div>
<div class="SmallExamples"><B>declare</B><BR>
&nbsp;&nbsp;Inserted&nbsp;:&nbsp;Boolean;&nbsp;C&nbsp;:&nbsp;Cursor;<BR>
<B>begin</B><BR>
&nbsp;&nbsp;Insert&nbsp;(Container,&nbsp;New_Item,&nbsp;C,&nbsp;Inserted);<BR>
&nbsp;&nbsp;<B>if&nbsp;not</B>&nbsp;Inserted&nbsp;<B>then</B><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<B>raise</B>&nbsp;Constraint_Error;<BR>
&nbsp;&nbsp;<B>end&nbsp;if</B>;<BR>
<B>end</B>;</div>
<div class="paranum"><a name="p42.c">42.c/2</a></div>
<div class="Annotations">but doesn't require the hassle of <B>out</B> 
parameters.&nbsp;</div>
<div class="paranum"><a name="p43">43/2</a></div>
<div class="Examples"><B>procedure</B>&nbsp;Include&nbsp;(Container&nbsp;:&nbsp;<B>in&nbsp;out</B>&nbsp;Set;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;New_Item&nbsp;&nbsp;:&nbsp;<B>in</B>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Element_Type);</div>
<div class="paranum"><a name="p44">44/2</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
Include inserts New_Item into Container as per the four-parameter Insert, 
with the difference that if an element equivalent to New_Item is already 
in the set, then it is replaced. Any exception raised during assignment 
is propagated.</div>
<div class="paranum"><a name="p45">45/2</a></div>
<div class="Examples"><B>procedure</B>&nbsp;Replace&nbsp;(Container&nbsp;:&nbsp;<B>in&nbsp;out</B>&nbsp;Set;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;New_Item&nbsp;&nbsp;:&nbsp;<B>in</B>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Element_Type);</div>
<div class="paranum"><a name="p46">46/2</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
Replace checks if an element equivalent to New_Item is already in the 
set. If a match is found, that element is replaced with New_Item; otherwise, 
Constraint_Error is propagated.</div>
<div class="paranum"><a name="p47">47/2</a></div>
<div class="Examples"><B>procedure</B>&nbsp;Exclude&nbsp;(Container&nbsp;:&nbsp;<B>in&nbsp;out</B>&nbsp;Set;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Item&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;<B>in</B>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Element_Type);</div>
<div class="paranum"><a name="p48">48/2</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
Exclude checks if an element equivalent to Item is present in Container. 
If a match is found, Exclude removes the element from the set.</div>
<div class="paranum"><a name="p49">49/2</a></div>
<div class="Examples"><B>procedure</B>&nbsp;Delete&nbsp;(Container&nbsp;:&nbsp;<B>in&nbsp;out</B>&nbsp;Set;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Item&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;<B>in</B>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Element_Type);</div>
<div class="paranum"><a name="p50">50/2</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
Delete checks if an element equivalent to Item is present in Container. 
If a match is found, Delete removes the element from the set; otherwise, 
Constraint_Error is propagated.</div>
<div class="paranum"><a name="p51">51/2</a></div>
<div class="Examples"><B>procedure</B>&nbsp;Delete&nbsp;(Container&nbsp;:&nbsp;<B>in&nbsp;out</B>&nbsp;Set;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Position&nbsp;&nbsp;:&nbsp;<B>in&nbsp;out</B>&nbsp;Cursor);</div>
<div class="paranum"><a name="p52">52/2</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
If Position equals No_Element, then Constraint_Error is propagated. If 
Position does not designate an element in Container, then Program_Error 
is propagated. Otherwise, Delete removes the element designated by Position 
from the set. Position is set to No_Element on return.</div>
<div class="paranum"><a name="p52.a">52.a/2</a></div>
<div class="Annotations"><B>Ramification:&nbsp;</B>The check on Position checks 
that the cursor does not belong to some other set. This check implies 
that a reference to the set is included in the cursor value. This wording 
is not meant to require detection of dangling cursors; such cursors are 
defined to be invalid, which means that execution is erroneous, and any 
result is allowed (including not raising an exception).&nbsp;</div>
<div class="paranum"><a name="p53">53/2</a></div>
<div class="Examples"><B>procedure</B>&nbsp;Union&nbsp;(Target&nbsp;:&nbsp;<B>in&nbsp;out</B>&nbsp;Set;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Source&nbsp;:&nbsp;<B>in</B>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set);</div>
<div class="paranum"><a name="p54">54/2</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
Union inserts into Target the elements of Source that are not equivalent 
to some element already in Target.</div>
<div class="paranum"><a name="p54.a">54.a/2</a></div>
<div class="Annotations"><B>Implementation Note:&nbsp;</B>If the objects are 
the same, the result is the same as the original object. The implementation 
needs to take care so that aliasing effects do not make the result trash; 
Union (S, S); must work.&nbsp;</div>
<div class="paranum"><a name="p55">55/2</a></div>
<div class="Examples"><B>function</B>&nbsp;Union&nbsp;(Left,&nbsp;Right&nbsp;:&nbsp;Set)&nbsp;<B>return</B>&nbsp;Set;</div>
<div class="paranum"><a name="p56">56/2</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
Returns a set comprising all of the elements of Left, and the elements 
of Right that are not equivalent to some element of Left.</div>
<div class="paranum"><a name="p57">57/2</a></div>
<div class="Examples"><B>procedure</B>&nbsp;Intersection&nbsp;(Target&nbsp;:&nbsp;<B>in&nbsp;out</B>&nbsp;Set;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Source&nbsp;:&nbsp;<B>in</B>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set);</div>
<div class="paranum"><a name="p58">58/3</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0004-1.TXT">AI05-0004-1</A></I>} 
Intersection deletes from Target the elements of Target that are not 
equivalent to some element of Source.</div>
<div class="paranum"><a name="p58.a">58.a/2</a></div>
<div class="Annotations"><B>Implementation Note:&nbsp;</B>If the objects are 
the same, the result is the same as the original object. The implementation 
needs to take care so that aliasing effects do not make the result trash; 
Intersection (S, S); must work.&nbsp;</div>
<div class="paranum"><a name="p59">59/2</a></div>
<div class="Examples"><B>function</B>&nbsp;Intersection&nbsp;(Left,&nbsp;Right&nbsp;:&nbsp;Set)&nbsp;<B>return</B>&nbsp;Set;</div>
<div class="paranum"><a name="p60">60/2</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
Returns a set comprising all the elements of Left that are equivalent 
to the some element of Right.</div>
<div class="paranum"><a name="p61">61/2</a></div>
<div class="Examples"><B>procedure</B>&nbsp;Difference&nbsp;(Target&nbsp;:&nbsp;<B>in&nbsp;out</B>&nbsp;Set;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Source&nbsp;:&nbsp;<B>in</B>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set);</div>
<div class="paranum"><a name="p62">62/2</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
If Target denotes the same object as Source, then Difference clears Target. 
Otherwise, it deletes from Target the elements that are equivalent to 
some element of Source.</div>
<div class="paranum"><a name="p63">63/2</a></div>
<div class="Examples"><B>function</B>&nbsp;Difference&nbsp;(Left,&nbsp;Right&nbsp;:&nbsp;Set)&nbsp;<B>return</B>&nbsp;Set;</div>
<div class="paranum"><a name="p64">64/2</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
Returns a set comprising the elements of Left that are not equivalent 
to some element of Right.</div>
<div class="paranum"><a name="p65">65/2</a></div>
<div class="Examples"><B>procedure</B>&nbsp;Symmetric_Difference&nbsp;(Target&nbsp;:&nbsp;<B>in&nbsp;out</B>&nbsp;Set;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Source&nbsp;:&nbsp;<B>in</B>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set);</div>
<div class="paranum"><a name="p66">66/2</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
If Target denotes the same object as Source, then Symmetric_Difference 
clears Target. Otherwise, it deletes from Target the elements that are 
equivalent to some element of Source, and inserts into Target the elements 
of Source that are not equivalent to some element of Target.</div>
<div class="paranum"><a name="p67">67/2</a></div>
<div class="Examples"><B>function</B>&nbsp;Symmetric_Difference&nbsp;(Left,&nbsp;Right&nbsp;:&nbsp;Set)&nbsp;<B>return</B>&nbsp;Set;</div>
<div class="paranum"><a name="p68">68/2</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
Returns a set comprising the elements of Left that are not equivalent 
to some element of Right, and the elements of Right that are not equivalent 
to some element of Left.</div>
<div class="paranum"><a name="p69">69/2</a></div>
<div class="Examples"><B>function</B>&nbsp;Overlap&nbsp;(Left,&nbsp;Right&nbsp;:&nbsp;Set)&nbsp;<B>return</B>&nbsp;Boolean;</div>
<div class="paranum"><a name="p70">70/3</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0264-1.TXT">AI05-0264-1</A></I>} 
If an element of Left is equivalent to some element of Right, then Overlap 
returns True. Otherwise, it returns False.</div>
<div class="paranum"><a name="p70.a">70.a/2</a></div>
<div class="Annotations"><B>Discussion:&nbsp;</B>This operation is commutative. 
If Overlap returns False, the two sets are disjoint.&nbsp;</div>
<div class="paranum"><a name="p71">71/2</a></div>
<div class="Examples"><B>function</B>&nbsp;Is_Subset&nbsp;(Subset&nbsp;:&nbsp;Set;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Of_Set&nbsp;:&nbsp;Set)&nbsp;<B>return</B>&nbsp;Boolean;</div>
<div class="paranum"><a name="p72">72/3</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0264-1.TXT">AI05-0264-1</A></I>} 
If an element of Subset is not equivalent to some element of Of_Set, 
then Is_Subset returns False. Otherwise, it returns True.</div>
<div class="paranum"><a name="p72.a">72.a/2</a></div>
<div class="Annotations"><B>Discussion:&nbsp;</B>This operation is not commutative, 
so we use parameter names that make it clear in named notation which 
set is which.&nbsp;</div>
<div class="paranum"><a name="p73">73/2</a></div>
<div class="Examples"><B>function</B>&nbsp;First&nbsp;(Container&nbsp;:&nbsp;Set)&nbsp;<B>return</B>&nbsp;Cursor;</div>
<div class="paranum"><a name="p74">74/2</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
If Length (Container) = 0, then First returns No_Element. Otherwise, 
First returns a cursor that designates the first element in Container.</div>
<div class="paranum"><a name="p75">75/2</a></div>
<div class="Examples"><B>function</B>&nbsp;Next&nbsp;(Position&nbsp;&nbsp;:&nbsp;Cursor)&nbsp;<B>return</B>&nbsp;Cursor;</div>
<div class="paranum"><a name="p76">76/2</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
Returns a cursor that designates the successor of the element designated 
by Position. If Position designates the last element, then No_Element 
is returned. If Position equals No_Element, then No_Element is returned.</div>
<div class="paranum"><a name="p77">77/2</a></div>
<div class="Examples"><B>procedure</B>&nbsp;Next&nbsp;(Position&nbsp;&nbsp;:&nbsp;<B>in&nbsp;out</B>&nbsp;Cursor);</div>
<div class="paranum"><a name="p78">78/2</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
Equivalent to Position := Next (Position).</div>
<div class="paranum"><a name="p79">79/3</a></div>
<div class="Indented2"><SPAN STYLE="font-size: 80%"><I>This paragraph 
was deleted.</I></SPAN>{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0004-1.TXT">AI05-0004-1</A></I>} 
</div>
<div class="paranum"><a name="p80">80/2</a></div>
<div class="Examples"><B>function</B>&nbsp;Find&nbsp;(Container&nbsp;:&nbsp;Set;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Item&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;Element_Type)&nbsp;<B>return</B>&nbsp;Cursor;</div>
<div class="paranum"><a name="p81">81/2</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
If Length (Container) equals 0, then Find returns No_Element. Otherwise, 
Find checks if an element equivalent to Item is present in Container. 
If a match is found, a cursor designating the matching element is returned; 
otherwise, No_Element is returned.</div>
<div class="paranum"><a name="p82">82/2</a></div>
<div class="Examples"><B>function</B>&nbsp;Contains&nbsp;(Container&nbsp;:&nbsp;Set;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Item&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;Element_Type)&nbsp;<B>return</B>&nbsp;Boolean;</div>
<div class="paranum"><a name="p82.1">82.1/3</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0004-1.TXT">AI05-0004-1</A></I>} 
Equivalent to Find (Container, Item) /= No_Element.</div>
<div class="paranum"><a name="p83">83/3</a></div>
<div class="Examples"></div>
<div class="paranum"><a name="p84">84/3</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0212-1.TXT">AI05-0212-1</A></I>} 
</div>
<div class="paranum"><a name="p84.a">84.a/3</a></div>
<div class="Annotations">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0212-1.TXT">AI05-0212-1</A></I>} 
</div>
<div class="Indented2"><SPAN STYLE="font-size: 80%"><I>Paragraphs 83 
and 84 were moved above.</I></SPAN>&nbsp;</div>
<div class="paranum"><a name="p85">85/2</a></div>
<div class="Examples"><B>procedure</B>&nbsp;Iterate<BR>
&nbsp;&nbsp;(Container&nbsp;:&nbsp;<B>in</B>&nbsp;Set;<BR>
&nbsp;&nbsp;&nbsp;Process&nbsp;&nbsp;&nbsp;:&nbsp;<B>not&nbsp;null&nbsp;access&nbsp;procedure</B>&nbsp;(Position&nbsp;:&nbsp;<B>in</B>&nbsp;Cursor));</div>
<div class="paranum"><a name="p86">86/3</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0265-1.TXT">AI05-0265-1</A></I>} 
Iterate calls Process.<B>all</B> with a cursor that designates each element 
in Container, starting with the first element and moving the cursor according 
to the successor relation. Tampering with the cursors of Container is 
prohibited during the execution of a call on Process.<B>all</B>. Any 
exception raised by Process.<B>all</B> is propagated.</div>
<div class="paranum"><a name="p86.a">86.a/2</a></div>
<div class="Annotations"><B>Implementation Note:&nbsp;</B>The &ldquo;tamper 
with cursors&rdquo; check takes place when the operations that insert 
or delete elements, and so on are called.</div>
<div class="paranum"><a name="p86.b">86.b/2</a></div>
<div class="Annotations">See Iterate for vectors (<A HREF="AA-A-18-2.html">A.18.2</A>) 
for a suggested implementation of the check.&nbsp;</div>
<div class="paranum"><a name="p87">87/2</a></div>
<div class="Normal">&nbsp;{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
Both Containers.Hashed_Set and Containers.Ordered_Set declare a nested 
generic package Generic_Keys, which provides operations that allow set 
manipulation in terms of a key (typically, a portion of an element) instead 
of a complete element. The formal function Key of Generic_Keys extracts 
a key value from an element. It is expected to return the same value 
each time it is called with a particular element. The behavior of Generic_Keys 
is unspecified if Key behaves in some other manner.<A NAME="I7670"></A></div>
<div class="paranum"><a name="p88">88/2</a></div>
<div class="Normal">&nbsp;{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
A key is expected to unambiguously determine a single equivalence class 
for elements. The behavior of Generic_Keys is unspecified if the formal 
parameters of this package behave in some other manner.<A NAME="I7671"></A></div>
<div class="paranum"><a name="p89">89/2</a></div>
<div class="Examples"><B>function</B>&nbsp;Key&nbsp;(Position&nbsp;:&nbsp;Cursor)&nbsp;<B>return</B>&nbsp;Key_Type;</div>
<div class="paranum"><a name="p90">90/2</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
Equivalent to Key (Element (Position)).&nbsp;</div>
<div class="paranum"><a name="p91">91/2</a></div>
<div class="Normal">&nbsp;{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
The subprograms in package Generic_Keys named Contains, Find, Element, 
Delete, and Exclude, are equivalent to the corresponding subprograms 
in the parent package, with the difference that the Key parameter is 
used to locate an element in the set.</div>
<div class="paranum"><a name="p92">92/2</a></div>
<div class="Examples"><B>procedure</B>&nbsp;Replace&nbsp;(Container&nbsp;:&nbsp;<B>in&nbsp;out</B>&nbsp;Set;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Key&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;<B>in</B>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Key_Type;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;New_Item&nbsp;&nbsp;:&nbsp;<B>in</B>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Element_Type);</div>
<div class="paranum"><a name="p93">93/2</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
Equivalent to Replace_Element (Container, Find (Container, Key), New_Item).</div>
<div class="paranum"><a name="p94">94/2</a></div>
<div class="Examples"><B>procedure</B>&nbsp;Update_Element_Preserving_Key<BR>
&nbsp;&nbsp;(Container&nbsp;:&nbsp;<B>in&nbsp;out</B>&nbsp;Set;<BR>
&nbsp;&nbsp;&nbsp;Position&nbsp;&nbsp;:&nbsp;<B>in</B>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cursor;<BR>
&nbsp;&nbsp;&nbsp;Process&nbsp;&nbsp;&nbsp;:&nbsp;<B>not&nbsp;null&nbsp;access&nbsp;procedure</B><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Element&nbsp;:&nbsp;<B>in&nbsp;out</B>&nbsp;Element_Type));</div>
<div class="paranum"><a name="p95">95/3</a></div>
<div class="Indented2">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0265-1.TXT">AI05-0265-1</A></I>} 
If Position equals No_Element, then Constraint_Error is propagated; if 
Position does not designate an element in Container, then Program_Error 
is propagated. Otherwise, Update_Element_Preserving_Key uses Key to save 
the key value <I>K</I> of the element designated by Position. Update_Element_Preserving_Key 
then calls Process.<B>all</B> with that element as the argument. Tampering 
with the elements of Container is prohibited during the execution of 
the call on Process.<B>all</B>. Any exception raised by Process.<B>all</B> 
is propagated. After Process.<B>all</B> returns, Update_Element_Preserving_Key 
checks if <I>K</I> determines the same equivalence class as that for 
the new element; if not, the element is removed from the set and Program_Error 
is propagated.</div>
<div class="paranum"><a name="p95.a">95.a/2</a></div>
<div class="Annotations"><B>Reason:&nbsp;</B>The key check ensures that the 
invariants of the set are preserved by the modification. The &ldquo;tampers 
with the elements&rdquo; check prevents data loss (if Element_Type is 
by-copy) or erroneous execution (if element type is unconstrained and 
indefinite).&nbsp;</div>
<div class="paranum"><a name="p96">96/2</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">If Element_Type 
is unconstrained and definite, then the actual Element parameter of Process.<B>all</B> 
shall be unconstrained.</div>
<div class="paranum"><a name="p96.a">96.a/2</a></div>
<div class="Annotations"><B>Ramification:&nbsp;</B>This means that the elements 
cannot be directly allocated from the heap; it must be possible to change 
the discriminants of the element in place.&nbsp;</div>
<div class="paranum"><a name="p96.1">96.1/3</a></div>
<div class="Examples"><B>type</B>&nbsp;Reference_Type&nbsp;(Element&nbsp;:&nbsp;<B>not&nbsp;null&nbsp;access</B>&nbsp;Element_Type)&nbsp;<B>is&nbsp;private</B><BR>
&nbsp;&nbsp;&nbsp;<B>with</B>&nbsp;Implicit_Dereference&nbsp;=&gt;&nbsp;Element;</div>
<div class="paranum"><a name="p96.2">96.2/3</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0212-1.TXT">AI05-0212-1</A></I>} 
The type Reference_Type needs finalization.<A NAME="I7672"></A></div>
<div class="paranum"><a name="p96.3">96.3/3</a></div>
<div class="Indented2">The default initialization of an object of type 
Reference_Type propagates Program_Error.</div>
<div class="paranum"><a name="p96.4">96.4/3</a></div>
<div class="Examples"><B>function</B>&nbsp;Reference_Preserving_Key&nbsp;(Container&nbsp;:&nbsp;<B>aliased&nbsp;in&nbsp;out</B>&nbsp;Set;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Position&nbsp;&nbsp;:&nbsp;<B>in</B>&nbsp;Cursor)<BR>
&nbsp;&nbsp;&nbsp;<B>return</B>&nbsp;Reference_Type;</div>
<div class="paranum"><a name="p96.5">96.5/3</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0212-1.TXT">AI05-0212-1</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0269-1.TXT">AI05-0269-1</A></I>} 
This function (combined with the Implicit_Dereference aspect) provides 
a convenient way to gain read and write access to an individual element 
of a set given a cursor.</div>
<div class="paranum"><a name="p96.6">96.6/3</a></div>
<div class="Indented2">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0212-1.TXT">AI05-0212-1</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0265-1.TXT">AI05-0265-1</A></I>} 
If Position equals No_Element, then Constraint_Error is propagated; if 
Position does not designate an element in Container, then Program_Error 
is propagated. Otherwise, Reference_Preserving_Key uses Key to save the 
key value <I>K</I>; then returns an object whose discriminant is an access 
value that designates the element designated by Position. Tampering with 
the elements of Container is prohibited while the object returned by 
Reference_Preserving_Key exists and has not been finalized. When the 
object returned by Reference_Preserving_Key is finalized, a check is 
made if <I>K</I> determines the same equivalence class as that for the 
new element; if not, the element is removed from the set and Program_Error 
is propagated.</div>
<div class="paranum"><a name="p96.7">96.7/3</a></div>
<div class="Examples"><B>function</B>&nbsp;Constant_Reference&nbsp;(Container&nbsp;:&nbsp;<B>aliased&nbsp;in</B>&nbsp;Set;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Key&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;<B>in</B>&nbsp;Key_Type)<BR>
&nbsp;&nbsp;&nbsp;<B>return</B>&nbsp;Constant_Reference_Type;</div>
<div class="paranum"><a name="p96.8">96.8/3</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0212-1.TXT">AI05-0212-1</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0269-1.TXT">AI05-0269-1</A></I>} 
This function (combined with the Implicit_Dereference aspect) provides 
a convenient way to gain read access to an individual element of a set 
given a key value.</div>
<div class="paranum"><a name="p96.9">96.9/3</a></div>
<div class="Indented2">Equivalent to Constant_Reference (Container, Find 
(Container, Key)).</div>
<div class="paranum"><a name="p96.10">96.10/3</a></div>
<div class="Examples"><B>function</B>&nbsp;Reference_Preserving_Key&nbsp;(Container&nbsp;:&nbsp;<B>aliased&nbsp;in&nbsp;out</B>&nbsp;Set;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Key&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;<B>in</B>&nbsp;Key_Type)<BR>
&nbsp;&nbsp;&nbsp;<B>return</B>&nbsp;Reference_Type;</div>
<div class="paranum"><a name="p96.11">96.11/3</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0212-1.TXT">AI05-0212-1</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0269-1.TXT">AI05-0269-1</A></I>} 
This function (combined with the Implicit_Dereference aspect) provides 
a convenient way to gain read and write access to an individual element 
of a set given a key value.</div>
<div class="paranum"><a name="p96.12">96.12/3</a></div>
<div class="Indented2">Equivalent to Reference_Preserving_Key (Container, 
Find (Container, Key)).&nbsp;</div>

<H4 Class="centered">Bounded (Run-Time) Errors</H4>
<div class="paranum"><a name="p96.13">96.13/3</a></div>
<div class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0022-1.TXT">AI05-0022-1</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0248-1.TXT">AI05-0248-1</A></I>} 
<A NAME="I7673"></A>It is a bounded error for the actual function associated 
with a generic formal subprogram, when called as part of an operation 
of a set package, to tamper with elements of any set parameter of the 
operation. Either Program_Error is raised, or the operation works as 
defined on the value of the set either prior to, or subsequent to, some 
or all of the modifications to the set.</div>
<div class="paranum"><a name="p96.14">96.14/3</a></div>
<div class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0027-1.TXT">AI05-0027-1</A></I>} 
<A NAME="I7674"></A>It is a bounded error to call any subprogram declared 
in the visible part of a set package when the associated container has 
been finalized. If the operation takes Container as an <B>in out</B> 
parameter, then it raises Constraint_Error or Program_Error. Otherwise, 
the operation either proceeds as it would for an empty container, or 
it raises Constraint_Error or Program_Error.&nbsp;</div>

<H4 Class="centered">Erroneous Execution</H4>
<div class="paranum"><a name="p97">97/2</a></div>
<div class="Normal" style="margin-bottom: 0.4em">&nbsp;{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
A Cursor value is <I>invalid</I> if any of the following have occurred 
since it was created:<A NAME="I7675"></A> <A NAME="I7676"></A></div>
<div class="paranum"><a name="p98">98/2</a></div>
<div class="Bulleted">The set that contains the element it designates 
has been finalized;</div>
<div class="paranum"><a name="p98.1">98.1/3</a></div>
<div class="Bulleted">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0160-1.TXT">AI05-0160-1</A></I>} 
The set that contains the element it designates has been used as the 
Target of a call to Assign, or as the target of an <SPAN Class="swiss"><A HREF="AA-5-2.html#S0152">assignment_statement</A></SPAN>;</div>
<div class="paranum"><a name="p99">99/2</a></div>
<div class="Bulleted">The set that contains the element it designates 
has been used as the Source or Target of a call to Move; or</div>
<div class="paranum"><a name="p100">100/3</a></div>
<div class="Bulleted">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0160-1.TXT">AI05-0160-1</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0262-1.TXT">AI05-0262-1</A></I>} 
The element it designates has been removed from the set that previously 
contained the element.&nbsp;</div>
<div class="paranum"><a name="p100.a">100.a/3</a></div>
<div class="Annotations"><B>Ramification:&nbsp;</B>{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0160-1.TXT">AI05-0160-1</A></I>} 
This can happen directly via calls to Clear, Exclude, Delete, and Update_Element_Preserving_Key, 
and indirectly via calls to procedures Intersection, Difference, and 
Symmetric_Difference.&nbsp;</div>
<div class="paranum"><a name="p101">101/2</a></div>
<div class="Normal">&nbsp;&nbsp;{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
The result of &quot;=&quot; or Has_Element is unspecified if these functions 
are called with an invalid cursor parameter.<A NAME="I7677"></A> Execution 
is erroneous if any other subprogram declared in Containers.Hashed_Sets 
or Containers.Ordered_Sets is called with an invalid cursor parameter.<A NAME="I7678"></A></div>
<div class="paranum"><a name="p101.a">101.a/2</a></div>
<div class="Annotations"><B>Discussion:&nbsp;</B>The list above is intended 
to be exhaustive. In other cases, a cursor value continues to designate 
its original element. For instance, cursor values survive the insertion 
and deletion of other elements.</div>
<div class="paranum"><a name="p101.b">101.b/2</a></div>
<div class="Annotations">While it is possible to check for these cases, 
in many cases the overhead necessary to make the check is substantial 
in time or space. Implementations are encouraged to check for as many 
of these cases as possible and raise Program_Error if detected.&nbsp;</div>
<div class="paranum"><a name="p101.1">101.1/3</a></div>
<div class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0212-1.TXT">AI05-0212-1</A></I>} 
Execution is erroneous if the set associated with the result of a call 
to Reference or Constant_Reference is finalized before the result object 
returned by the call to Reference or Constant_Reference is finalized. 
</div>
<div class="paranum"><a name="p101.c">101.c/3</a></div>
<div class="Annotations"><B>Reason:&nbsp;</B>Each object of Reference_Type 
and Constant_Reference_Type probably contains some reference to the originating 
container. If that container is prematurely finalized (which is only 
possible via Unchecked_Deallocation, as accessibility checks prevent 
passing a container to Reference that will not live as long as the result), 
the finalization of the object of Reference_Type will try to access a 
nonexistent object. This is a normal case of a dangling pointer created 
by Unchecked_Deallocation; we have to explicitly mention it here as the 
pointer in question is not visible in the specification of the type. 
(This is the same reason we have to say this for invalid cursors.)&nbsp;</div>

<H4 Class="centered">Implementation Requirements</H4>
<div class="paranum"><a name="p102">102/2</a></div>
<div class="Normal">&nbsp;&nbsp;{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
No storage associated with a Set object shall be lost upon assignment 
or scope exit.</div>
<div class="paranum"><a name="p103">103/3</a></div>
<div class="Normal">&nbsp;&nbsp;{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0262-1.TXT">AI05-0262-1</A></I>} 
The execution of an <SPAN Class="swiss"><A HREF="AA-5-2.html#S0152">assignment_statement</A></SPAN> 
for a set shall have the effect of copying the elements from the source 
set object to the target set object and changing the length of the target 
object to that of the source object.</div>
<div class="paranum"><a name="p103.a">103.a/3</a></div>
<div class="Annotations"><B>Implementation Note:&nbsp;</B>{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0298-1.TXT">AI05-0298-1</A></I>} 
An assignment of a Set is a &ldquo;deep&rdquo; copy; that is the elements 
are copied as well as the data structures. We say &ldquo;effect of&rdquo; 
in order to allow the implementation to avoid copying elements immediately 
if it wishes. For instance, an implementation that avoided copying until 
one of the containers is modified would be allowed. (Note that this implementation 
would require care, see <A HREF="AA-A-18-2.html">A.18.2</A> for more.) 
</div>

<H4 Class="centered">Implementation Advice</H4>
<div class="paranum"><a name="p104">104/2</a></div>
<div class="Normal">&nbsp;&nbsp;{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
Move should not copy elements, and should minimize copying of internal 
data structures.&nbsp;</div>
<div class="paranum"><a name="p104.a">104.a/2</a></div>
<div class="Annotations"><B>Implementation Advice:&nbsp;</B>Move for sets 
should not copy elements, and should minimize copying of internal data 
structures.</div>
<div class="paranum"><a name="p104.b">104.b/2</a></div>
<div class="Annotations"><B>Implementation Note:&nbsp;</B>Usually that can 
be accomplished simply by moving the pointer(s) to the internal data 
structures from the Source container to the Target container.&nbsp;</div>
<div class="paranum"><a name="p105">105/2</a></div>
<div class="Normal">&nbsp;&nbsp;{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
If an exception is propagated from a set operation, no storage should 
be lost, nor any elements removed from a set unless specified by the 
operation.&nbsp;</div>
<div class="paranum"><a name="p105.a">105.a/2</a></div>
<div class="Annotations"><B>Implementation Advice:&nbsp;</B>If an exception 
is propagated from a set operation, no storage should be lost, nor any 
elements removed from a set unless specified by the operation.</div>
<div class="paranum"><a name="p105.b">105.b/2</a></div>
<div class="Annotations"><B>Reason:&nbsp;</B>This is important so that programs 
can recover from errors. But we don't want to require heroic efforts, 
so we just require documentation of cases where this can't be accomplished. 
</div>

<H4 Class="centered">Wording Changes from Ada 95</H4>
<div class="paranum"><a name="p105.c">105.c/2</a></div>
<div class="Annotations">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-20302.TXT">AI95-00302-03</A></I>} 
This description of sets is new; the extensions are documented with the 
specific packages.&nbsp;</div>

<H4 Class="centered">Extensions to Ada 2005</H4>
<div class="paranum"><a name="p105.d">105.d/3</a></div>
<div class="Annotations">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0212-1.TXT">AI05-0212-1</A></I>} 
<A NAME="I7679"></A>Added reference support to make set containers more 
convenient to use.&nbsp;</div>

<H4 Class="centered">Wording Changes from Ada 2005</H4>
<div class="paranum"><a name="p105.e">105.e/3</a></div>
<div class="Annotations">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0001-1.TXT">AI05-0001-1</A></I>} 
Added procedure Assign; the extension and incompatibility is documented 
with the specific packages.</div>
<div class="paranum"><a name="p105.f">105.f/3</a></div>
<div class="Annotations">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0001-1.TXT">AI05-0001-1</A></I>} 
Generalized the definition of Move. Specified which elements are read/written 
by stream attributes.</div>
<div class="paranum"><a name="p105.g">105.g/3</a></div>
<div class="Annotations">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0022-1.TXT">AI05-0022-1</A></I>} 
<B>Correction:</B> Added a Bounded (Run-Time) Error to cover tampering 
by generic actual subprograms.</div>
<div class="paranum"><a name="p105.h">105.h/3</a></div>
<div class="Annotations">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0027-1.TXT">AI05-0027-1</A></I>} 
<B>Correction:</B> Added a Bounded (Run-Time) Error to cover access to 
finalized set containers.</div>
<div class="paranum"><a name="p105.i">105.i/3</a></div>
<div class="Annotations">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0160-1.TXT">AI05-0160-1</A></I>} 
<B>Correction:</B> Revised the definition of invalid cursors to cover 
missing (and new) cases.</div>
<div class="paranum"><a name="p105.j">105.j/3</a></div>
<div class="Annotations">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0265-1.TXT">AI05-0265-1</A></I>} 
<B>Correction:</B> Defined when a container prohibits tampering in order 
to more clearly define where the check is made and the exception raised. 
</div>

<H4 Class="centered">Wording Changes from Ada 2012</H4>
<div class="paranum"><a name="p105.k">105.k/4</a></div>
<div class="Annotations">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI12s/AI12-0110-1.TXT">AI12-0110-1</A></I>} 
<span class="insert4"><B>Corrigendum:</B> Clarified that tampering checks 
precede all other checks made by a subprogram (but come after those associated 
with the call).</span>&nbsp;</div>

<HR>
<div style="margin-top: 0.0em; margin-bottom: 0.6em"><A HREF="AA-TOC.html"><IMG SRC="cont.gif" ALT="Contents" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-0-5.html"><IMG SRC="index.gif" ALT="Index" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-STDS.html"><IMG SRC="lib.gif" ALT="References" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-SRCH.html"><IMG SRC="find.gif" ALT="Search" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-A-18-6.html"><IMG SRC="prev.gif" ALT="Previous" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-A-18-8.html"><IMG SRC="next.gif" ALT="Next" BORDER=0></A>&nbsp;
</div>
<DIV Style="margin-top:0.0em"><IMG SRC="AE_logo.gif" height=100 width=113 align=right ALT="Ada-Europe">
<SPAN Style="vertical-align: middle; font-size:120%">Ada 2005 and 2012 Editions sponsored in part by <SPAN Style="font-size: 125%"><A HREF="http://www.ada-europe.org/"><B>Ada-Europe</B></A></SPAN></SPAN></DIV>
</BODY>
</HTML>
