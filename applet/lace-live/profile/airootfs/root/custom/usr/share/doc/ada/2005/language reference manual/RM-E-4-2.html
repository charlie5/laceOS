<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<HTML>
<HEAD>
    <TITLE>Example of Use of a Remote Access-to-Class-Wide Type</TITLE>
    <META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <META NAME="Author" CONTENT="JTC1/SC22/WG9/ARG, by Randall Brukardt, ARG Editor">
    <META NAME="GENERATOR" CONTENT="Arm_Form.Exe, Ada Reference Manual generator">
    <STYLE type="text/css">
    H4.centered {text-align: center}
    SPAN.swiss {font-family: Arial, Helvetica, sans-serif; font-size: 92%}
    SPAN.roman {font-family: "Times New Roman", Times, serif}
    DIV.paranum {float: left; font-family: Arial, Helvetica, sans-serif; font-size: 64%; width: 2.8em; margin-left: -0.4em; margin-right: -3.0em; margin-top: 0.2em}
    TT {font-family: "Courier New", monospace}
    DT {display: compact}
    DIV.Normal {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 1.2em; margin-bottom: 0.6em}
    DIV.Examples {font-family: "Courier New", monospace; font-size: 90%; line-height: 122%; margin-left: 3.4em; margin-bottom: 0.6em}
    UL.Bulleted {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 3.2em; margin-right: 2.0em; margin-top: 0em; margin-bottom: 0.5em}
    </STYLE>
</HEAD>
<BODY TEXT="#000000" BGCOLOR="#FFFFF0" LINK="#000080" VLINK="#330033" ALINK="#0000FF">
<DIV><SPAN Style="font-size:200%; color: rgb(0,0,153)"><B>Ada Reference Manual</B></SPAN> &mdash; <A HREF="RM-TTL.html"><B>Legal Information</B></A></DIV>
<DIV Style="margin-top: 0.6em; margin-bottom: 0.0em"><A HREF="RM-TOC.html"><IMG SRC="cont.gif" ALT="Contents" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-0-5.html"><IMG SRC="index.gif" ALT="Index" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-STDS.html"><IMG SRC="lib.gif" ALT="References" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-SRCH.html"><IMG SRC="find.gif" ALT="Search" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-E-4-1.html"><IMG SRC="prev.gif" ALT="Previous" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-E-5.html"><IMG SRC="next.gif" ALT="Next" BORDER=0></A>&nbsp;
</DIV>
<HR>
<H1>E.4.2 Example of Use of a Remote Access-to-Class-Wide Type</H1>

<H4 Class="centered">Examples</H4>
<DIV Class="paranum">1</DIV>
<DIV Class="Normal" Style="margin-bottom: 0.4em"><I>Example of using 
a remote access-to-class-wide type to achieve dynamic binding across 
active partitions:</I>&nbsp;</DIV>
<DIV Class="paranum">2</DIV>
<DIV Class="Examples"><B>package</B>&nbsp;Tapes&nbsp;<B>is</B><BR>
&nbsp;&nbsp;&nbsp;<B>pragma</B>&nbsp;Pure(Tapes);<BR>
&nbsp;&nbsp;&nbsp;<B>type</B>&nbsp;Tape&nbsp;<B>is&nbsp;abstract&nbsp;tagged&nbsp;limited&nbsp;private</B>;<BR>
&nbsp;&nbsp;&nbsp;<SPAN Class="roman"><I>--&nbsp;Primitive&nbsp;dispatching&nbsp;operations&nbsp;where</I></SPAN><BR>
&nbsp;&nbsp;&nbsp;<SPAN Class="roman"><I>--&nbsp;Tape&nbsp;is&nbsp;controlling&nbsp;operand</I></SPAN><BR>
&nbsp;&nbsp;&nbsp;<B>procedure</B>&nbsp;Copy&nbsp;(From,&nbsp;To&nbsp;:&nbsp;<B>access</B>&nbsp;Tape;&nbsp;Num_Recs&nbsp;:&nbsp;<B>in</B>&nbsp;Natural)&nbsp;<B>is</B>&nbsp;<B>abstract</B>;<BR>
&nbsp;&nbsp;&nbsp;<B>procedure</B>&nbsp;Rewind&nbsp;(T&nbsp;:&nbsp;<B>access</B>&nbsp;Tape)&nbsp;<B>is</B>&nbsp;<B>abstract</B>;<BR>
&nbsp;&nbsp;&nbsp;<SPAN Class="roman"><I>--&nbsp;More&nbsp;operations</I></SPAN><BR>
<B>private</B><BR>
&nbsp;&nbsp;&nbsp;<B>type</B>&nbsp;Tape&nbsp;<B>is</B>&nbsp;...<BR>
<B>end</B>&nbsp;Tapes;</DIV>
<DIV Class="paranum">3</DIV>
<DIV Class="Examples"><B>with</B>&nbsp;Tapes;<BR>
<B>package</B>&nbsp;Name_Server&nbsp;<B>is</B><BR>
&nbsp;&nbsp;&nbsp;<B>pragma</B>&nbsp;Remote_Call_Interface;<BR>
&nbsp;&nbsp;&nbsp;<SPAN Class="roman"><I>--&nbsp;Dynamic&nbsp;binding&nbsp;to&nbsp;remote&nbsp;operations&nbsp;is&nbsp;achieved</I></SPAN><BR>
&nbsp;&nbsp;&nbsp;<SPAN Class="roman"><I>--&nbsp;using&nbsp;the&nbsp;access-to-limited-class-wide&nbsp;type&nbsp;Tape_Ptr</I></SPAN><BR>
&nbsp;&nbsp;&nbsp;<B>type</B>&nbsp;Tape_Ptr&nbsp;<B>is&nbsp;access&nbsp;all</B>&nbsp;Tapes.Tape'Class;<BR>
&nbsp;&nbsp;&nbsp;<SPAN Class="roman"><I>--&nbsp;The&nbsp;following&nbsp;statically&nbsp;bound&nbsp;remote&nbsp;operations</I></SPAN><BR>
&nbsp;&nbsp;&nbsp;<SPAN Class="roman"><I>--&nbsp;allow&nbsp;for&nbsp;a&nbsp;name-server&nbsp;capability&nbsp;in&nbsp;this&nbsp;example</I></SPAN><BR>
&nbsp;&nbsp;&nbsp;<B>function</B>&nbsp;&nbsp;Find&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Name&nbsp;:&nbsp;String)&nbsp;<B>return</B>&nbsp;Tape_Ptr;<BR>
&nbsp;&nbsp;&nbsp;<B>procedure</B>&nbsp;Register&nbsp;(Name&nbsp;:&nbsp;<B>in</B>&nbsp;String;&nbsp;T&nbsp;:&nbsp;<B>in</B>&nbsp;Tape_Ptr);<BR>
&nbsp;&nbsp;&nbsp;<B>procedure</B>&nbsp;Remove&nbsp;&nbsp;&nbsp;(T&nbsp;:&nbsp;<B>in</B>&nbsp;Tape_Ptr);<BR>
&nbsp;&nbsp;&nbsp;<SPAN Class="roman"><I>--&nbsp;More&nbsp;operations</I></SPAN><BR>
<B>end</B>&nbsp;Name_Server;</DIV>
<DIV Class="paranum">4</DIV>
<DIV Class="Examples"><B>package</B>&nbsp;Tape_Driver&nbsp;<B>is</B><BR>
&nbsp;&nbsp;<SPAN Class="roman"><I>--&nbsp;Declarations&nbsp;are&nbsp;not&nbsp;shown,&nbsp;they&nbsp;are&nbsp;irrelevant&nbsp;here</I></SPAN><BR>
<B>end</B>&nbsp;Tape_Driver;</DIV>
<DIV Class="paranum">5</DIV>
<DIV Class="Examples"><B>with</B>&nbsp;Tapes,&nbsp;Name_Server;<BR>
<B>package&nbsp;body</B>&nbsp;Tape_Driver&nbsp;<B>is</B><BR>
&nbsp;&nbsp;&nbsp;<B>type</B>&nbsp;New_Tape&nbsp;<B>is&nbsp;new</B>&nbsp;Tapes.Tape&nbsp;<B>with</B>&nbsp;...<BR>
&nbsp;&nbsp;&nbsp;<B>procedure</B>&nbsp;Copy<BR>
&nbsp;&nbsp;&nbsp;&nbsp;(From,&nbsp;To&nbsp;:&nbsp;<B>access</B>&nbsp;New_Tape;&nbsp;Num_Recs:&nbsp;<B>in</B>&nbsp;Natural)&nbsp;<B>is</B><BR>
&nbsp;&nbsp;&nbsp;<B>begin</B><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.&nbsp;.&nbsp;.<BR>
&nbsp;&nbsp;&nbsp;<B>end</B>&nbsp;Copy;<BR>
&nbsp;&nbsp;&nbsp;<B>procedure</B>&nbsp;Rewind&nbsp;(T&nbsp;:&nbsp;<B>access</B>&nbsp;New_Tape)&nbsp;<B>is</B><BR>
&nbsp;&nbsp;&nbsp;<B>begin</B><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.&nbsp;.&nbsp;.<BR>
&nbsp;&nbsp;&nbsp;<B>end</B>&nbsp;Rewind;<BR>
&nbsp;&nbsp;&nbsp;<SPAN Class="roman"><I>--&nbsp;Objects&nbsp;remotely&nbsp;accessible&nbsp;through&nbsp;use</I></SPAN><BR>
&nbsp;&nbsp;&nbsp;<SPAN Class="roman"><I>--&nbsp;of&nbsp;Name_Server&nbsp;operations</I></SPAN><BR>
&nbsp;&nbsp;&nbsp;Tape1,&nbsp;Tape2&nbsp;:&nbsp;<B>aliased</B>&nbsp;New_Tape;<BR>
<B>begin</B><BR>
&nbsp;&nbsp;&nbsp;Name_Server.Register&nbsp;(&quot;NINE-TRACK&quot;,&nbsp;&nbsp;Tape1'Access);<BR>
&nbsp;&nbsp;&nbsp;Name_Server.Register&nbsp;(&quot;SEVEN-TRACK&quot;,&nbsp;Tape2'Access);<BR>
<B>end</B>&nbsp;Tape_Driver;</DIV>
<DIV Class="paranum">6</DIV>
<DIV Class="Examples"><B>with</B>&nbsp;Tapes,&nbsp;Name_Server;<BR>
<SPAN Class="roman"><I>--&nbsp;Tape_Driver&nbsp;is&nbsp;not&nbsp;needed&nbsp;and&nbsp;thus&nbsp;not&nbsp;mentioned&nbsp;in&nbsp;the&nbsp;</I></SPAN><SPAN Class="swiss"><I><A HREF="RM-10-1-2.html#S0237">with_clause</A></I></SPAN><SPAN Class="roman"><I></I></SPAN><BR>
<B>procedure</B>&nbsp;Tape_Client&nbsp;<B>is</B><BR>
&nbsp;&nbsp;&nbsp;T1,&nbsp;T2&nbsp;:&nbsp;Name_Server.Tape_Ptr;<BR>
<B>begin</B><BR>
&nbsp;&nbsp;&nbsp;T1&nbsp;:=&nbsp;Name_Server.Find&nbsp;(&quot;NINE-TRACK&quot;);<BR>
&nbsp;&nbsp;&nbsp;T2&nbsp;:=&nbsp;Name_Server.Find&nbsp;(&quot;SEVEN-TRACK&quot;);<BR>
&nbsp;&nbsp;&nbsp;Tapes.Rewind&nbsp;(T1);<BR>
&nbsp;&nbsp;&nbsp;Tapes.Rewind&nbsp;(T2);<BR>
&nbsp;&nbsp;&nbsp;Tapes.Copy&nbsp;(T1,&nbsp;T2,&nbsp;3);<BR>
<B>end</B>&nbsp;Tape_Client;</DIV>
<DIV Class="paranum">7</DIV>
<DIV Class="Normal" Style="margin-bottom: 0.4em"><I>Notes on the example</I>: 
</DIV>
<DIV Class="paranum">8/1</DIV>
<DIV Class="Normal"><SPAN STYLE="font-size: 80%"><I>This paragraph was 
deleted.</I></SPAN></DIV>
<DIV Class="paranum">9</DIV>
<UL Class="Bulleted"><LI TYPE=DISC>The package Tapes provides the necessary 
declarations of the type and its primitive operations.</LI></UL>
<DIV Class="paranum">10</DIV>
<UL Class="Bulleted"><LI TYPE=DISC>Name_Server is a remote call interface 
package and is elaborated in a separate active partition to provide the 
necessary naming services (such as Register and Find) to the entire distributed 
program through remote subprogram calls.</LI></UL>
<DIV Class="paranum">11</DIV>
<UL Class="Bulleted"><LI TYPE=DISC>Tape_Driver is a normal package that 
is elaborated in a partition configured on the processing node that is 
connected to the tape device(s). The abstract operations are overridden 
to support the locally declared tape devices (Tape1, Tape2). The package 
is not visible to its clients, but it exports the tape devices (as remote 
objects) through the services of the Name_Server. This allows for tape 
devices to be dynamically added, removed or replaced without requiring 
the modification of the clients' code.</LI></UL>
<DIV Class="paranum">12</DIV>
<UL Class="Bulleted"><LI TYPE=DISC>The Tape_Client procedure references 
only declarations in the Tapes and Name_Server packages. Before using 
a tape for the first time, it needs to query the Name_Server for a system-wide 
identity for that tape. From then on, it can use that identity to access 
the tape device.</LI></UL>
<DIV Class="paranum">13</DIV>
<UL Class="Bulleted"><LI TYPE=DISC>Values of remote access type Tape_Ptr 
include the necessary information to complete the remote dispatching 
operations that result from dereferencing the controlling operands T1 
and T2.</LI></UL>

<HR>
<DIV Style="margin-top: 0.0em; margin-bottom: 0.6em"><A HREF="RM-TOC.html"><IMG SRC="cont.gif" ALT="Contents" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-0-5.html"><IMG SRC="index.gif" ALT="Index" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-STDS.html"><IMG SRC="lib.gif" ALT="References" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-SRCH.html"><IMG SRC="find.gif" ALT="Search" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-E-4-1.html"><IMG SRC="prev.gif" ALT="Previous" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-E-5.html"><IMG SRC="next.gif" ALT="Next" BORDER=0></A>&nbsp;
</DIV>
<DIV Style="margin-top:0.0em"><IMG SRC="AE_logo.gif" height=100 width=113 align=right ALT="Ada-Europe">
<SPAN Style="vertical-align: middle">Sponsored by <SPAN Style="font-size: 125%"><A HREF="http://www.ada-europe.org/"><B>Ada-Europe</B></A></SPAN></SPAN></DIV>
</BODY>
</HTML>
