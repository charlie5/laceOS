<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<HTML>
<HEAD>
    <TITLE>The Generic Package Containers.Bounded_Hashed_Maps</TITLE>
    <META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <META NAME="Author" CONTENT="JTC1/SC22/WG9/ARG, by Randall Brukardt, ARG Editor">
    <META NAME="GENERATOR" CONTENT="Arm_Form.Exe, Ada Reference Manual generator">
    <STYLE type="text/css">
    H4.centered {text-align: center}
    SPAN.swiss {font-family: Arial, Helvetica, sans-serif; font-size: 92%}
    SPAN.roman {font-family: "Times New Roman", Times, serif}
    DIV.paranum {float: left; font-family: Arial, Helvetica, sans-serif; font-size: 64%; width: 2.8em; margin-left: -0.4em; margin-right: -3.0em; margin-top: 0.2em}
    TT {font-family: "Courier New", monospace}
    DT {display: compact}
    A.Bar:link {font-family: Arial, Helvetica, sans-serif; font-style: normal; text-decoration: none; color: rgb(204,204,51)}
    A.Bar:visited {font-family: Arial, Helvetica, sans-serif; font-style: normal; text-decoration: none; color: rgb(204,204,51)}
    DIV.Normal {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 1.2em; margin-bottom: 0.6em}
    DIV.Indented2 {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 5.2em; margin-bottom: 0.6em}
    DIV.Annotations {font-family: "Times New Roman", Times, serif; font-size: 80%; line-height: 122%; margin-left: 6.2em; margin-bottom: 0.6em}
    DIV.Examples {font-family: "Courier New", monospace; font-size: 90%; line-height: 122%; margin-left: 3.4em; margin-bottom: 0.6em}
    DIV.Bulleted-NoPrefix {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 3.2em; margin-right: 2.0em; margin-top: 0em; margin-bottom: 0.5em}
    DIV.Bulleted {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 3.2em; margin-right: 2.0em; margin-top: 0em; margin-bottom: 0.5em; display: list-item; list-style-type: disc}
    </STYLE>
</HEAD>
<BODY TEXT="#000000" BGCOLOR="#FFFFF0" LINK="#000080" VLINK="#330033" ALINK="#0000FF">
<DIV><B><SPAN Style="font-size:200%; color: rgb(0,51,153)">Annotated</SPAN><SPAN Style="font-size:200%; color: rgb(0,0,102)">&nbsp;Ada Reference Manual</SPAN></B> &mdash; <A HREF="AA-TTL.html"><B>Legal Information</B></A></DIV>
<div style="margin-top: 0.6em; margin-bottom: 0.0em"><A HREF="AA-TOC.html"><IMG SRC="cont.gif" ALT="Contents" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-0-5.html"><IMG SRC="index.gif" ALT="Index" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-STDS.html"><IMG SRC="lib.gif" ALT="References" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-SRCH.html"><IMG SRC="find.gif" ALT="Search" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-A-18-20.html"><IMG SRC="prev.gif" ALT="Previous" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-A-18-22.html"><IMG SRC="next.gif" ALT="Next" BORDER=0></A>&nbsp;
</div>
<HR>
<H1>A.18.21 The Generic Package Containers.Bounded_Hashed_Maps</H1>
<div class="paranum"><a name="p1">1/3</a></div>
<div class="Normal">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0001-1.TXT">AI05-0001-1</A></I>} 
The language-defined generic package Containers.Bounded_Hashed_Maps provides 
a private type Map and a set of operations. It provides the same operations 
as the package Containers.Hashed_Maps (see <A HREF="AA-A-18-5.html">A.18.5</A>), 
with the difference that the maximum storage is bounded.</div>

<H4 Class="centered">Static Semantics</H4>
<div class="paranum"><a name="p2">2/3</a></div>
<div class="Normal" style="margin-bottom: 0.4em">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0001-1.TXT">AI05-0001-1</A></I>} 
The declaration of the generic library package Containers.Bounded_Hashed_Maps 
has the same contents and semantics as Containers.Hashed_Maps except:</div>
<div class="paranum"><a name="p3">3/3</a></div>
<div class="Bulleted">The <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN> 
Preelaborate is replaced with <SPAN Class="swiss"><A HREF="AA-2-8.html#S0019">pragma</A></SPAN> 
Pure.</div>
<div class="paranum"><a name="p4">4/3</a></div>
<div class="Bulleted" style="margin-bottom: 0.3em">The type Map is declared 
with discriminants that specify both the capacity (number of elements) 
and modulus (number of distinct hash values) of the hash table as follows: 
</div>
<div class="paranum"><a name="p5">5/3</a></div>
<div class="Examples">&nbsp;&nbsp;<B>type</B>&nbsp;Map&nbsp;(Capacity&nbsp;:&nbsp;Count_Type;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Modulus&nbsp;&nbsp;:&nbsp;Hash_Type)&nbsp;<B>is&nbsp;tagged&nbsp;private</B>;</div>
<div class="paranum"><a name="p6">6/3</a></div>
<div class="Bulleted">The type Map needs finalization if and only if 
type Key_Type or type Element_Type needs finalization.</div>
<div class="paranum"><a name="p6.a">6.a/3</a></div>
<div class="Annotations"><B>Implementation Note:&nbsp;</B>{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0212-1.TXT">AI05-0212-1</A></I>} 
The type Map cannot depend on package Ada.Finalization unless the element 
or key type depends on that package. The objects returned from the Iterator 
and Reference functions probably do depend on package Ada.Finalization. 
Restricted environments may need to avoid use of those functions and 
their associated types.&nbsp;</div>
<div class="paranum"><a name="p7">7/3</a></div>
<div class="Bulleted" style="margin-bottom: 0.3em">The description of 
Reserve_Capacity is replaced with:&nbsp;</div>
<div class="paranum"><a name="p8">8/3</a></div>
<div class="Indented2">If the specified Capacity is larger than the capacity 
of Container, then Reserve_Capacity propagates Capacity_Error. Otherwise, 
the operation has no effect.&nbsp;</div>
<div class="paranum"><a name="p9">9/3</a></div>
<div class="Bulleted" style="margin-bottom: 0.3em">An additional operation 
is added immediately following Reserve_Capacity:&nbsp;</div>
<div class="paranum"><a name="p10">10/3</a></div>
<div class="Examples">&nbsp;&nbsp;<B>function</B>&nbsp;<A NAME="I7981"></A>Default_Modulus&nbsp;(Capacity&nbsp;:&nbsp;Count_Type)&nbsp;<B>return</B>&nbsp;Hash_Type;</div>
<div class="paranum"><a name="p11">11/3</a></div>
<div class="Indented2">Default_Modulus returns an implementation-defined 
value for the number of distinct hash values to be used for the given 
capacity (maximum number of elements).&nbsp;</div>
<div class="paranum"><a name="p12">12/3</a></div>
<div class="Bulleted" style="margin-bottom: 0.3em">The function Copy 
is replaced with:&nbsp;</div>
<div class="paranum"><a name="p13">13/3</a></div>
<div class="Examples">&nbsp;&nbsp;<B>function</B>&nbsp;<A NAME="I7982"></A>Copy&nbsp;(Source&nbsp;&nbsp;&nbsp;:&nbsp;Map;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Capacity&nbsp;:&nbsp;Count_Type&nbsp;:=&nbsp;0;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Modulus&nbsp;&nbsp;:&nbsp;Hash_Type&nbsp;:=&nbsp;0)&nbsp;<B>return</B>&nbsp;Map;</div>
<div class="paranum"><a name="p14">14/3</a></div>
<div class="Indented2">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0264-1.TXT">AI05-0264-1</A></I>} 
Returns a map with key/element pairs initialized from the values in Source. 
If Capacity is 0, then the map capacity is the length of Source; if Capacity 
is equal to or greater than the length of Source, the map capacity is 
the value of the Capacity parameter; otherwise, the operation propagates 
Capacity_Error.  If the Modulus argument is 0, then the map modulus is 
the value returned by a call to Default_Modulus with the map capacity 
as its argument; otherwise, the map modulus is the value of the Modulus 
parameter.&nbsp;</div>

<H4 Class="centered">Bounded (Run-Time) Errors</H4>
<div class="paranum"><a name="p15">15/3</a></div>
<div class="Normal">&nbsp;{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0160-1.TXT">AI05-0160-1</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0265-1.TXT">AI05-0265-1</A></I>} 
<A NAME="I7983"></A>It is a bounded error to assign from a bounded map 
object while tampering with elements [or cursors] of that object is prohibited. 
Either Program_Error is raised by the assignment, execution proceeds 
with the target object prohibiting tampering with elements [or cursors], 
or execution proceeds normally.&nbsp;</div>
<div class="paranum"><a name="p15.a">15.a/3</a></div>
<div class="Annotations"><B>Proof:&nbsp;</B>Tampering with elements includes 
tampering with cursors, so we only really need to talk about tampering 
with elements here; we mention cursors for clarity.&nbsp;</div>

<H4 Class="centered">Erroneous Execution</H4>
<div class="paranum"><a name="p16">16/3</a></div>
<div class="Normal">&nbsp;{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0265-1.TXT">AI05-0265-1</A></I>} 
When a bounded map object <I>M</I> is finalized, if tampering with cursors 
is prohibited for <I>M</I> other than due to an assignment from another 
map, then execution is erroneous. <A NAME="I7984"></A></div>
<div class="paranum"><a name="p16.a">16.a/3</a></div>
<div class="Annotations"><B>Reason:&nbsp;</B>This is a tampering event, but 
since the implementation is not allowed to use Ada.Finalization, it is 
not possible in a pure Ada implementation to detect this error. (There 
is no Finalize routine that will be called that could make the check.) 
Since the check probably cannot be made, the bad effects that could occur 
(such as an iterator going into an infinite loop or accessing a nonexistent 
element) cannot be prevented and we have to allow anything. We do allow 
re-assigning an object that only prohibits tampering because it was copied 
from another object as that cannot cause any negative effects.&nbsp;</div>

<H4 Class="centered">Implementation Requirements</H4>
<div class="paranum"><a name="p17">17/3</a></div>
<div class="Normal" style="margin-bottom: 0.4em">&nbsp;{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0184-1.TXT">AI05-0184-1</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0264-1.TXT">AI05-0264-1</A></I>} 
For each instance of Containers.Hashed_Maps and each instance of Containers.Bounded_Hashed_Maps, 
if the two instances meet the following conditions, then the output generated 
by the Map'Output or Map'Write subprograms of either instance shall be 
readable by the Map'Input or Map'Read of the other instance, respectively:</div>
<div class="paranum"><a name="p18">18/3</a></div>
<div class="Bulleted">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0184-1.TXT">AI05-0184-1</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0248-1.TXT">AI05-0248-1</A></I>} 
the Element_Type parameters of the two instances are statically matching 
subtypes of the same type; and</div>
<div class="paranum"><a name="p19">19/3</a></div>
<div class="Bulleted">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0184-1.TXT">AI05-0184-1</A></I>} 
the output generated by Element_Type'Output or Element_Type'Write is 
readable by Element_Type'Input or Element_Type'Read, respectively (where 
Element_Type denotes the type of the two actual Element_Type parameters); 
and</div>
<div class="paranum"><a name="p20">20/3</a></div>
<div class="Bulleted">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0184-1.TXT">AI05-0184-1</A></I>} 
the preceding two conditions also hold for the Key_Type parameters of 
the instances.&nbsp;</div>

<H4 Class="centered">Implementation Advice</H4>
<div class="paranum"><a name="p21">21/3</a></div>
<div class="Normal">&nbsp;{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0001-1.TXT">AI05-0001-1</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0269-1.TXT">AI05-0269-1</A></I>} 
Bounded hashed map objects should be implemented without implicit pointers 
or dynamic allocation.&nbsp;</div>
<div class="paranum"><a name="p21.a.1">21.a.1/3</a></div>
<div class="Annotations"><B>Implementation Advice:&nbsp;</B>Bounded hashed 
map objects should be implemented without implicit pointers or dynamic 
allocation.</div>
<div class="paranum"><a name="p22">22/3</a></div>
<div class="Normal">&nbsp;{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0001-1.TXT">AI05-0001-1</A></I>} 
The implementation advice for procedure Move to minimize copying does 
not apply.&nbsp;</div>
<div class="paranum"><a name="p22.a.1">22.a.1/3</a></div>
<div class="Annotations"><B>Implementation Advice:&nbsp;</B>The implementation 
advice for procedure Move to minimize copying does not apply to bounded 
hashed maps.</div>

<H4 Class="centered">Extensions to Ada 2005</H4>
<div class="paranum"><a name="p22.a">22.a/3</a></div>
<div class="Annotations">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0001-1.TXT">AI05-0001-1</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0160-1.TXT">AI05-0160-1</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0184-1.TXT">AI05-0184-1</A></I>} 
<A NAME="I7985"></A> The generic package Containers.Bounded_Hashed_Maps 
is new.&nbsp;</div>

<HR>
<div style="margin-top: 0.0em; margin-bottom: 0.6em"><A HREF="AA-TOC.html"><IMG SRC="cont.gif" ALT="Contents" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-0-5.html"><IMG SRC="index.gif" ALT="Index" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-STDS.html"><IMG SRC="lib.gif" ALT="References" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-SRCH.html"><IMG SRC="find.gif" ALT="Search" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-A-18-20.html"><IMG SRC="prev.gif" ALT="Previous" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-A-18-22.html"><IMG SRC="next.gif" ALT="Next" BORDER=0></A>&nbsp;
</div>
<DIV Style="margin-top:0.0em"><IMG SRC="AE_logo.gif" height=100 width=113 align=right ALT="Ada-Europe">
<SPAN Style="vertical-align: middle; font-size:120%">Ada 2005 and 2012 Editions sponsored in part by <SPAN Style="font-size: 125%"><A HREF="http://www.ada-europe.org/"><B>Ada-Europe</B></A></SPAN></SPAN></DIV>
</BODY>
</HTML>
