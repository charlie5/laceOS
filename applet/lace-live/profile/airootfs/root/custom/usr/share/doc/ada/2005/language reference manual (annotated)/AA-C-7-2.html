<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<HTML>
<HEAD>
    <TITLE>The Package Task_Attributes</TITLE>
    <META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <META NAME="Author" CONTENT="JTC1/SC22/WG9/ARG, by Randall Brukardt, ARG Editor">
    <META NAME="GENERATOR" CONTENT="Arm_Form.Exe, Ada Reference Manual generator">
    <STYLE type="text/css">
    H4.centered {text-align: center}
    SPAN.swiss {font-family: Arial, Helvetica, sans-serif; font-size: 92%}
    SPAN.roman {font-family: "Times New Roman", Times, serif}
    DIV.paranum {float: left; font-family: Arial, Helvetica, sans-serif; font-size: 64%; width: 2.8em; margin-left: -0.4em; margin-right: -3.0em; margin-top: 0.2em}
    TT {font-family: "Courier New", monospace}
    DT {display: compact}
    SPAN.insert1 {text-decoration: underline; color: rgb(0,51,51) }
    SPAN.delete1 {text-decoration: line-through; color: rgb(0,51,51) }
    SPAN.insert2 {text-decoration: underline; color: rgb(0,102,0) }
    SPAN.delete2 {text-decoration: line-through; color: rgb(0,102,0) }
    DIV.Normal {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 1.2em; margin-bottom: 0.6em}
    DIV.Annotations {font-family: "Times New Roman", Times, serif; font-size: 80%; line-height: 122%; margin-left: 6.2em; margin-bottom: 0.6em}
    DIV.Notes {font-family: "Times New Roman", Times, serif; font-size: 80%; line-height: 122%; margin-left: 3.7em; margin-bottom: 0.6em}
    DIV.NotesHeader {font-family: "Times New Roman", Times, serif; font-size: 80%; line-height: 122%; margin-left: 3.7em}
    DIV.Examples {font-family: "Courier New", monospace; font-size: 90%; line-height: 122%; margin-left: 3.4em; margin-bottom: 0.6em}
    UL.Bulleted {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 3.2em; margin-right: 2.0em; margin-top: 0em; margin-bottom: 0.5em}
    </STYLE>
</HEAD>
<BODY TEXT="#000000" BGCOLOR="#FFFFF0" LINK="#000080" VLINK="#330033" ALINK="#0000FF">
<DIV><B><SPAN Style="font-size:200%; color: rgb(0,51,153)">Annotated</SPAN><SPAN Style="font-size:200%; color: rgb(0,0,102)">&nbsp;Ada Reference Manual</SPAN></B> &mdash; <A HREF="AA-TTL.html"><B>Legal Information</B></A></DIV>
<DIV Style="margin-top: 0.6em; margin-bottom: 0.0em"><A HREF="AA-TOC.html"><IMG SRC="cont.gif" ALT="Contents" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-0-5.html"><IMG SRC="index.gif" ALT="Index" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-STDS.html"><IMG SRC="lib.gif" ALT="References" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-SRCH.html"><IMG SRC="find.gif" ALT="Search" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-C-7-1.html"><IMG SRC="prev.gif" ALT="Previous" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-C-7-3.html"><IMG SRC="next.gif" ALT="Next" BORDER=0></A>&nbsp;
</DIV>
<HR>
<H1>C.7.2 The Package Task_Attributes</H1>

<H4 Class="centered">Static Semantics</H4>
<DIV Class="paranum">1</DIV>
<DIV Class="Normal" Style="margin-bottom: 0.4em">The following language-defined 
generic library package exists:&nbsp;</DIV>
<DIV Class="paranum">2</DIV>
<DIV Class="Examples"><B>with</B>&nbsp;Ada.Task_Identification;&nbsp;<B>use</B>&nbsp;Ada.Task_Identification;<BR>
<B>generic</B><BR>
&nbsp;&nbsp;&nbsp;<B>type</B>&nbsp;Attribute&nbsp;<B>is</B>&nbsp;<B>private</B>;<BR>
&nbsp;&nbsp;&nbsp;Initial_Value&nbsp;:&nbsp;<B>in</B>&nbsp;Attribute;<BR>
<B>package</B>&nbsp;Ada.Task_Attributes&nbsp;<B>is</B><A NAME="I7367"></A></DIV>
<DIV Class="paranum">3</DIV>
<DIV Class="Examples">&nbsp;&nbsp;&nbsp;<B>type</B>&nbsp;<A NAME="I7368"></A>Attribute_Handle&nbsp;<B>is</B>&nbsp;<B>access</B>&nbsp;<B>all</B>&nbsp;Attribute;</DIV>
<DIV Class="paranum">4</DIV>
<DIV Class="Examples">&nbsp;&nbsp;&nbsp;<B>function</B>&nbsp;<A NAME="I7369"></A>Value(T&nbsp;:&nbsp;Task_Id&nbsp;:=&nbsp;Current_Task)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<B>return</B>&nbsp;Attribute;</DIV>
<DIV Class="paranum">5</DIV>
<DIV Class="Examples">&nbsp;&nbsp;&nbsp;<B>function</B>&nbsp;<A NAME="I7370"></A>Reference(T&nbsp;:&nbsp;Task_Id&nbsp;:=&nbsp;Current_Task)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<B>return</B>&nbsp;Attribute_Handle;</DIV>
<DIV Class="paranum">6</DIV>
<DIV Class="Examples">&nbsp;&nbsp;&nbsp;<B>procedure</B>&nbsp;<A NAME="I7371"></A>Set_Value(Val&nbsp;:&nbsp;<B>in</B>&nbsp;Attribute;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T&nbsp;:&nbsp;<B>in</B>&nbsp;Task_Id&nbsp;:=&nbsp;Current_Task);<BR>
&nbsp;&nbsp;&nbsp;<B>procedure</B>&nbsp;<A NAME="I7372"></A>Reinitialize(T&nbsp;:&nbsp;<B>in</B>&nbsp;Task_Id&nbsp;:=&nbsp;Current_Task);</DIV>
<DIV Class="paranum">7</DIV>
<DIV Class="Examples"><B>end</B>&nbsp;Ada.Task_Attributes;</DIV>

<H4 Class="centered">Dynamic Semantics</H4>
<DIV Class="paranum">8</DIV>
<DIV Class="Normal">When an instance of Task_Attributes is elaborated 
in a given active partition, an object of the actual type corresponding 
to the formal type Attribute is implicitly created for each task (of 
that partition) that exists and is not yet terminated. This object acts 
as a user-defined attribute of the task. A task created previously in 
the partition and not yet terminated has this attribute from that point 
on. Each task subsequently created in the partition will have this attribute 
when created. In all these cases, the initial value of the given attribute 
is Initial_Value.</DIV>
<DIV Class="paranum">9</DIV>
<DIV Class="Normal">The Value operation returns the value of the corresponding 
attribute of T.</DIV>
<DIV Class="paranum">10</DIV>
<DIV Class="Normal">The Reference operation returns an access value that 
designates the corresponding attribute of T.</DIV>
<DIV Class="paranum">11</DIV>
<DIV Class="Normal">The Set_Value operation performs any finalization 
on the old value of the attribute of T and assigns Val to that attribute 
(see <A HREF="AA-5-2.html">5.2</A> and <A HREF="AA-7-6.html">7.6</A>).</DIV>
<DIV Class="paranum">12</DIV>
<DIV Class="Normal">The effect of the Reinitialize operation is the same 
as Set_Value where the Val parameter is replaced with Initial_Value. 
</DIV>
<DIV Class="paranum">12.a</DIV>
<DIV Class="Annotations"><B>Implementation Note:&nbsp;</B>In most cases, the 
attribute memory can be reclaimed at this point.&nbsp;</DIV>
<DIV Class="paranum">13</DIV>
<DIV Class="Normal"><SPAN STYLE="font-size: 80%">{<I>Tasking_Error (raised 
by failure of run-time check)</I>}</SPAN> <A NAME="I7373"></A>For all 
the operations declared in this package, Tasking_Error is raised if the 
task identified by T is terminated. <SPAN STYLE="font-size: 80%">{<I>Program_Error 
(raised by failure of run-time check)</I>}</SPAN> <A NAME="I7374"></A>Program_Error 
is raised if the value of T is Null_Task_Id.</DIV>
<DIV Class="paranum">13.1/2</DIV>
<DIV Class="Normal">&nbsp;&nbsp;&nbsp;{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00237.TXT">AI95-00237-01</A></I>} 
<SPAN class="insert2">After a task has terminated, all of its attributes 
are finalized, unless they have been finalized earlier. When the master 
of an instantiation of Ada.Task_Attributes is finalized, the corresponding 
attribute of each task is finalized, unless it has been finalized earlier.</SPAN> 
</DIV>
<DIV Class="paranum">13.a/2</DIV>
<DIV Class="Annotations"><SPAN class="insert2"><B>Reason:&nbsp;</B>This is 
necessary so that a task attribute does not outlive its type. For instance, 
that's possible if the instantiation is nested, and the attribute is 
on a library-level task.</SPAN>&nbsp;</DIV>
<DIV Class="paranum">13.b/2</DIV>
<DIV Class="Annotations"><SPAN class="insert2"><B>Ramification:&nbsp;</B>The 
task owning an attribute cannot, in general, finalize that attribute. 
That's because the attributes are finalized <I>after</I> the task is 
terminated; moreover, a task may have attributes as soon as it is created; 
the task may never even have been activated.</SPAN>&nbsp;</DIV>

<H4 Class="centered">Bounded (Run-Time) Errors</H4>
<DIV Class="paranum">13.2/1</DIV>
<DIV Class="Normal">&nbsp;&nbsp;&nbsp;{<I><A HREF="defect1.html#8652/0071">8652/0071</A></I>} 
<SPAN class="insert1"></SPAN>{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00165.TXT">AI95-00165-01</A></I>} 
<SPAN class="insert1"><SPAN STYLE="font-size: 80%">{<I>bounded error 
(cause)</I> [partial]}</SPAN> <A NAME="I7375"></A>If the package Ada.Task_Attributes 
is instantiated with a controlled type and the controlled type has user-defined 
Adjust or Finalize operations that in turn access task attributes by 
any of the above operations, then a call of Set_Value of the instantiated 
package constitutes a bounded error. The call may perform as expected 
or may result in forever blocking the calling task and subsequently some 
or all tasks of the partition.</SPAN>&nbsp;</DIV>

<H4 Class="centered">Erroneous Execution</H4>
<DIV Class="paranum">14</DIV>
<DIV Class="Normal"><SPAN STYLE="font-size: 80%">{<I>erroneous execution 
(cause)</I> [partial]}</SPAN> <A NAME="I7376"></A>It is erroneous to 
dereference the access value returned by a given call on Reference after 
a subsequent call on Reinitialize for the same task attribute, or after 
the associated task terminates.&nbsp;</DIV>
<DIV Class="paranum">14.a</DIV>
<DIV Class="Annotations"><B>Reason:&nbsp;</B>This allows the storage to be 
reclaimed for the object associated with an attribute upon Reinitialize 
or task termination.&nbsp;</DIV>
<DIV Class="paranum">15</DIV>
<DIV Class="Normal"><SPAN STYLE="font-size: 80%">{<I>erroneous execution 
(cause)</I> [partial]}</SPAN> <A NAME="I7377"></A>If a value of Task_Id 
is passed as a parameter to any of the operations declared in this package 
and the corresponding task object no longer exists, the execution of 
the program is erroneous.</DIV>
<DIV Class="paranum">15.1/2</DIV>
<DIV Class="Normal">&nbsp;&nbsp;&nbsp;{<I><A HREF="defect1.html#8652/0071">8652/0071</A></I>} 
<SPAN class="insert1"></SPAN>{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00165.TXT">AI95-00165-01</A></I>} 
<SPAN class="insert1"></SPAN>{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00237.TXT">AI95-00237-01</A></I>} 
<SPAN class="insert1"><SPAN STYLE="font-size: 80%">{<I>erroneous execution 
(cause)</I> [partial]}</SPAN> <A NAME="I7378"></A></SPAN><SPAN class="insert2">An 
access</SPAN><SPAN class="insert1"></SPAN><SPAN class="insert1"><SPAN class="delete2">&nbsp;Accesses</SPAN></SPAN><SPAN class="insert1">&nbsp;to&nbsp;</SPAN><SPAN class="insert2">a&nbsp;</SPAN><SPAN class="insert1">task&nbsp;</SPAN><SPAN class="insert2">attribute</SPAN><SPAN class="insert1"></SPAN><SPAN class="insert1"><SPAN class="delete2">&nbsp;attributes</SPAN></SPAN><SPAN class="insert1">&nbsp;via a value of type Attribute_Handle&nbsp;</SPAN><SPAN class="insert2">is</SPAN><SPAN class="insert1"></SPAN><SPAN class="insert1"><SPAN class="delete2">&nbsp;are</SPAN></SPAN><SPAN class="insert1">&nbsp;erroneous if executed concurrently with&nbsp;</SPAN><SPAN class="insert2">another 
such access</SPAN><SPAN class="insert1"></SPAN><SPAN class="insert1"><SPAN class="delete2">&nbsp;each 
other</SPAN></SPAN><SPAN class="insert1">&nbsp;or&nbsp;</SPAN><SPAN class="insert2">a 
call</SPAN><SPAN class="insert1"></SPAN><SPAN class="insert1"><SPAN class="delete2">&nbsp;with 
calls</SPAN></SPAN><SPAN class="insert1">&nbsp;of any of the operations declared 
in package Task_Attributes.</SPAN><SPAN class="insert2">&nbsp;An access to 
a task attribute is erroneous if executed concurrently with or after 
the finalization of the task attribute.</SPAN><SPAN class="insert1"></SPAN> 
</DIV>
<DIV Class="paranum">15.a.1/1</DIV>
<DIV Class="Annotations"><SPAN class="insert1"><B>Reason:&nbsp;</B>There is 
no requirement of atomicity on accesses via a value of type Attribute_Handle.</SPAN> 
</DIV>
<DIV Class="paranum">15.a.2/2</DIV>
<DIV Class="Annotations"><SPAN class="insert2"><B>Ramification:&nbsp;</B>A 
task attribute can only be accessed after finalization through a value 
of type Attribute_Handle. Operations in package Task_Attributes cannot 
be used to access a task attribute after finalization, because either 
the master of the instance has been or is in the process of being left 
(in which case the instance is out of scope and thus cannot be called), 
or the associated task is already terminated (in which case Tasking_Error 
is raised for any attempt to call a task attribute operation).</SPAN> 
</DIV>

<H4 Class="centered">Implementation Requirements</H4>
<DIV Class="paranum">16/1</DIV>
<DIV Class="Normal">&nbsp;{<I><A HREF="defect1.html#8652/0071">8652/0071</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00165.TXT">AI95-00165-01</A></I>} 
<SPAN class="insert1">For a given attribute of a given task, the</SPAN><SPAN class="delete1">&nbsp;The</SPAN> 
implementation shall perform <SPAN class="insert1">the operations declared 
in this package</SPAN><SPAN class="delete1">&nbsp;each of the above operations 
for a given attribute of a given task</SPAN> atomically with respect 
to any <SPAN class="insert1">of these operations of</SPAN><SPAN class="delete1">&nbsp;other 
of the above operations for</SPAN> the same attribute of the same task. 
<SPAN class="insert1">The granularity of any locking mechanism necessary 
to achieve such atomicity is implementation defined.</SPAN>&nbsp;</DIV>
<DIV Class="paranum">16.a.1/1</DIV>
<DIV Class="Annotations"><SPAN class="insert1"><B>Implementation defined: 
</B></SPAN><SPAN class="insert1">Granularity of locking for Task_Attributes.</SPAN></DIV>
<DIV Class="paranum">16.a</DIV>
<DIV Class="Annotations"><B>Ramification:&nbsp;</B>Hence, other than by dereferencing 
an access value returned by Reference, an attribute of a given task can 
be safely read and updated concurrently by multiple tasks.&nbsp;</DIV>
<DIV Class="paranum">17/2</DIV>
<DIV Class="Normal">&nbsp;{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00237.TXT">AI95-00237-01</A></I>} 
<SPAN class="insert2">After</SPAN><SPAN class="delete2">&nbsp;When a</SPAN> 
task <SPAN class="insert2">attributes are finalized</SPAN><SPAN class="delete2">&nbsp;terminates</SPAN>, 
the implementation shall <SPAN class="delete2">finalize all attributes 
of the task, and&nbsp;</SPAN>reclaim any <SPAN class="delete2">other&nbsp;</SPAN>storage 
associated with the attributes.&nbsp;</DIV>

<H4 Class="centered">Documentation Requirements</H4>
<DIV Class="paranum">18</DIV>
<DIV Class="Normal">The implementation shall document the limit on the 
number of attributes per task, if any, and the limit on the total storage 
for attribute values per task, if such a limit exists.</DIV>
<DIV Class="paranum">19</DIV>
<DIV Class="Normal">In addition, if these limits can be configured, the 
implementation shall document how to configure them.&nbsp;</DIV>
<DIV Class="paranum">19.a/2</DIV>
<DIV Class="Annotations"><SPAN STYLE="font-size: 80%"><I>This paragraph 
was deleted.</I></SPAN><SPAN class="delete2"><B>Implementation defined: 
</B></SPAN><SPAN class="delete2"></SPAN><SPAN class="insert1"><SPAN class="delete2">Limits 
on the number and size of task attributes, and how to configure them.</SPAN></SPAN><SPAN class="delete2"></SPAN><SPAN class="delete1">&nbsp;Implementation-defined 
aspects of Task_Attributes.</SPAN><SPAN class="delete2"></SPAN></DIV>
<DIV Class="paranum">19.b/2</DIV>
<DIV Class="Annotations"><SPAN class="insert2"><B>Documentation Requirement: 
</B></SPAN><SPAN class="insert2">For package Task_Attributes, limits 
on the number and size of task attributes, and how to configure any limits.</SPAN></DIV>

<H4 Class="centered">Metrics</H4>
<DIV Class="paranum">20/2</DIV>
<DIV Class="Normal">&nbsp;{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00434.TXT">AI95-00434-01</A></I>} 
The implementation shall document the following metrics: A task calling 
the following subprograms shall execute <SPAN class="insert2">at</SPAN><SPAN class="delete2">&nbsp;in</SPAN> 
a sufficiently high priority as to not be preempted during the measurement 
period. This period shall start just before issuing the call and end 
just after the call completes. If the attributes of task T are accessed 
by the measurement tests, no other task shall access attributes of that 
task during the measurement period. For all measurements described here, 
the Attribute type shall be a scalar <SPAN class="insert2">type&nbsp;</SPAN>whose 
size is equal to the size of the predefined <SPAN class="insert2">type 
Integer</SPAN><SPAN class="delete2">&nbsp;integer size</SPAN>. For each measurement, 
two cases shall be documented: one where the accessed attributes are 
of the calling task [(that is, the default value for the T parameter 
is used)], and the other, where T identifies another, non-terminated, 
task.</DIV>
<DIV Class="paranum">21</DIV>
<DIV Class="Normal" Style="margin-bottom: 0.4em">The following calls 
(to subprograms in the Task_Attributes package) shall be measured:&nbsp;</DIV>
<DIV Class="paranum">22</DIV>
<UL Class="Bulleted"><LI TYPE=DISC>a call to Value, where the return 
value is Initial_Value;</LI></UL>
<DIV Class="paranum">23</DIV>
<UL Class="Bulleted"><LI TYPE=DISC>a call to Value, where the return 
value is not equal to Initial_Value;</LI></UL>
<DIV Class="paranum">24</DIV>
<UL Class="Bulleted"><LI TYPE=DISC>a call to Reference, where the return 
value designates a value equal to Initial_Value;</LI></UL>
<DIV Class="paranum">25</DIV>
<UL Class="Bulleted"><LI TYPE=DISC>a call to Reference, where the return 
value designates a value not equal to Initial_Value;</LI></UL>
<DIV Class="paranum">26/2</DIV>
<UL Class="Bulleted"><LI TYPE=DISC>{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00434.TXT">AI95-00434-01</A></I>} 
a call to Set_Value where the Val parameter is not equal to Initial_Value 
and the old attribute value is equal to Initial_Value<SPAN class="insert2">;</SPAN><SPAN class="delete2">.</SPAN></LI></UL>
<DIV Class="paranum">27</DIV>
<UL Class="Bulleted"><LI TYPE=DISC>a call to Set_Value where the Val 
parameter is not equal to Initial_Value and the old attribute value is 
not equal to Initial_Value.</LI></UL>
<DIV Class="paranum">27.a/2</DIV>
<DIV Class="Annotations"><SPAN class="insert2"><B>Documentation Requirement: 
</B></SPAN><SPAN class="insert2">The metrics for the Task_Attributes 
package.</SPAN></DIV>

<H4 Class="centered">Implementation Permissions</H4>
<DIV Class="paranum">28</DIV>
<DIV Class="Normal">An implementation need not actually create the object 
corresponding to a task attribute until its value is set to something 
other than that of Initial_Value, or until Reference is called for the 
task attribute. Similarly, when the value of the attribute is to be reinitialized 
to that of Initial_Value, the object may instead be finalized and its 
storage reclaimed, to be recreated when needed later. While the object 
does not exist, the function Value may simply return Initial_Value, rather 
than implicitly creating the object.&nbsp;</DIV>
<DIV Class="paranum">28.a</DIV>
<DIV Class="Annotations"><B>Discussion:&nbsp;</B>The effect of this permission 
can only be observed if the assignment operation for the corresponding 
type has side-effects.&nbsp;</DIV>
<DIV Class="paranum">28.b/2</DIV>
<DIV Class="Annotations"><B>Implementation Note:&nbsp;</B>{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00114.TXT">AI95-00114-01</A></I>} 
This permission means that even though every task has every attribute, 
storage need only be allocated for those attributes <SPAN class="insert2">for 
which function Reference has been invoked</SPAN><SPAN class="delete2">&nbsp;that 
have been Reference'd</SPAN> or set to a value other than that of Initial_Value. 
</DIV>
<DIV Class="paranum">29</DIV>
<DIV Class="Normal">An implementation is allowed to place restrictions 
on the maximum number of attributes a task may have, the maximum size 
of each attribute, and the total storage size allocated for all the attributes 
of a task.</DIV>

<H4 Class="centered">Implementation Advice</H4>
<DIV Class="paranum">30/2</DIV>
<DIV Class="Normal">&nbsp;{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00434.TXT">AI95-00434-01</A></I>} 
Some implementations are targeted to domains in which memory use at run 
time must be completely deterministic. For such implementations, it is 
recommended that the storage for task attributes will be pre-allocated 
statically and not from the heap. This can be accomplished by either 
placing restrictions on the number and the size of the <SPAN class="delete2">task's 
</SPAN>attributes<SPAN class="insert2">&nbsp;of a task</SPAN>, or by using 
the pre-allocated storage for the first N attribute objects, and the 
heap for the others. In the latter case, N should be documented.</DIV>
<DIV Class="paranum">30.a/2</DIV>
<DIV Class="Annotations"><SPAN class="insert2"><B>Implementation Advice: 
</B></SPAN><SPAN class="insert2">If the target domain requires deterministic 
memory use at run time, storage for task attributes should be pre-allocated 
statically and the number of attributes pre-allocated should be documented.</SPAN></DIV>
<DIV Class="paranum">30.b/2</DIV>
<DIV Class="Annotations"><SPAN class="insert2"><B>Discussion:&nbsp;</B>We 
don't mention &ldquo;restrictions on the size and number&rdquo; (that 
is, limits) in the text for the Annex, because it is covered by the Documentation 
Requirement above, and we try not to repeat requirements in the Annex 
(they're enough work to meet without having to do things twice).</SPAN> 
</DIV>
<DIV Class="paranum">30.1/2</DIV>
<DIV Class="Normal">&nbsp;&nbsp;&nbsp;{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00237.TXT">AI95-00237-01</A></I>} 
<SPAN class="insert2">Finalization of task attributes and reclamation 
of associated storage should be performed as soon as possible after task 
termination.</SPAN>&nbsp;</DIV>
<DIV Class="paranum">30.c/2</DIV>
<DIV Class="Annotations"><SPAN class="insert2"><B>Implementation Advice: 
</B></SPAN><SPAN class="insert2">Finalization of task attributes and 
reclamation of associated storage should be performed as soon as possible 
after task termination.</SPAN></DIV>
<DIV Class="paranum">30.d/2</DIV>
<DIV Class="Annotations"><SPAN class="insert2"><B>Reason:&nbsp;</B></SPAN>{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00237.TXT">AI95-00237-01</A></I>} 
<SPAN class="insert2">This is necessary because the normative wording 
only says that attributes are finalized &ldquo;after&rdquo; task termination. 
Without this advice, waiting until the instance is finalized would meet 
the requirements (it is after termination, but may be a very long time 
after termination). We can't say anything more specific than this, as 
we do not want to require the overhead of an interaction with the tasking 
system to be done at a specific point.</SPAN>&nbsp;</DIV>
<DIV Class="NotesHeader">NOTES</DIV>
<DIV Class="paranum">31</DIV>
<DIV Class="Notes">12&nbsp;&nbsp;An attribute always exists (after instantiation), 
and has the initial value. It need not occupy memory until the first 
operation that potentially changes the attribute value. The same holds 
true after Reinitialize.</DIV>
<DIV Class="paranum">32</DIV>
<DIV Class="Notes">13&nbsp;&nbsp;The result of the Reference function 
should be used with care; it is always safe to use that result in the 
task body whose attribute is being accessed. However, when the result 
is being used by another task, the programmer must make sure that the 
task whose attribute is being accessed is not yet terminated. Failing 
to do so could make the program execution erroneous.</DIV>
<DIV Class="paranum">33/2</DIV>
<DIV Class="Notes"><SPAN STYLE="font-size: 80%"><I>This paragraph was 
deleted.</I></SPAN><SPAN class="delete2">14&nbsp;&nbsp;</SPAN>{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00434.TXT">AI95-00434-01</A></I>} 
<SPAN class="delete2">As specified in <A HREF="AA-C-7-1.html">C.7.1</A>, 
if the parameter T (in a call on a subprogram of an instance of this 
package) identifies a nonexistent task, the execution of the program 
is erroneous.</SPAN>&nbsp;</DIV>

<H4 Class="centered">Wording Changes from Ada 95</H4>
<DIV Class="paranum">33.a/2</DIV>
<DIV Class="Annotations">{<I><A HREF="defect1.html#8652/0071">8652/0071</A></I>} 
<SPAN class="insert2"></SPAN>{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00165.TXT">AI95-00165-01</A></I>} 
<SPAN class="insert2"><B>Corrigendum:</B> Clarified that use of task 
attribute operations from within a task attribute operation (by an Adjust 
or Finalize call) is a bounded error, and that concurrent use of attribute 
handles is erroneous.</SPAN></DIV>
<DIV Class="paranum">33.b/2</DIV>
<DIV Class="Annotations">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00237.TXT">AI95-00237-01</A></I>} 
<SPAN class="insert2">Clarified the wording so that the finalization 
takes place after the termination of the task or when the instance is 
finalized (whichever is sooner).</SPAN>&nbsp;</DIV>

<HR>
<DIV Style="margin-top: 0.0em; margin-bottom: 0.6em"><A HREF="AA-TOC.html"><IMG SRC="cont.gif" ALT="Contents" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-0-5.html"><IMG SRC="index.gif" ALT="Index" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-STDS.html"><IMG SRC="lib.gif" ALT="References" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-SRCH.html"><IMG SRC="find.gif" ALT="Search" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-C-7-1.html"><IMG SRC="prev.gif" ALT="Previous" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-C-7-3.html"><IMG SRC="next.gif" ALT="Next" BORDER=0></A>&nbsp;
</DIV>
<DIV Style="margin-top:0.0em"><IMG SRC="AE_logo.gif" height=100 width=113 align=right ALT="Ada-Europe">
<SPAN Style="font-size: 125%">Sponsored by <SPAN Style="font-size: 125%"><A HREF="http://www.ada-europe.org/"><B>Ada-Europe</B></A></SPAN></SPAN></DIV>
</BODY>
</HTML>
